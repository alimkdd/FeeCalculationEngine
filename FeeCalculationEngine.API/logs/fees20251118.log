2025-11-18 13:24:24.380 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:24:24.489 +02:00 [WRN] No store type was specified for the decimal property 'BaseFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:24:24.495 +02:00 [WRN] No store type was specified for the decimal property 'FinalFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:24:24.497 +02:00 [WRN] No store type was specified for the decimal property 'TotalDiscount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:24:24.500 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeModifier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:24:24.503 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'PromoCode'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:24:24.506 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'Tier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:24:24.509 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Transaction'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:24:24.512 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:24:24.517 +02:00 [WRN] No store type was specified for the decimal property 'FeeCharged' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:24:25.947 +02:00 [INF] Executed DbCommand (90ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [BusinessHolidays] AS [b]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:24:26.010 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PaymentMethods] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:24:26.027 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PromoCodes] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:24:26.053 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Tiers] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:24:26.077 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [TransactionTypes] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:24:26.099 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:24:26.123 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Transactions] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:24:26.138 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [FeeModifiers] AS [f]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:24:26.605 +02:00 [INF] Now listening on: https://localhost:7261
2025-11-18 13:24:26.608 +02:00 [INF] Now listening on: http://localhost:5186
2025-11-18 13:24:26.803 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-18 13:24:26.806 +02:00 [INF] Hosting environment: Development
2025-11-18 13:24:26.807 +02:00 [INF] Content root path: C:\Users\User\source\repos\FeeCalculationEngine\FeeCalculationEngine.API
2025-11-18 13:24:28.160 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - null null
2025-11-18 13:24:28.959 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - 200 null text/html;charset=utf-8 847.7688ms
2025-11-18 13:24:29.090 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - null null
2025-11-18 13:24:29.090 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - null null
2025-11-18 13:24:29.124 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - 200 16533 application/javascript; charset=utf-8 34.973ms
2025-11-18 13:24:29.268 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - 200 null text/javascript; charset=UTF-8 179.5203ms
2025-11-18 13:24:29.343 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - null null
2025-11-18 13:24:29.397 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 55.3347ms
2025-11-18 13:24:47.715 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Preview - application/json 84
2025-11-18 13:24:47.732 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Preview (FeeCalculationEngine.API)'
2025-11-18 13:24:47.772 +02:00 [INF] Route matched with {action = "Preview", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult] Preview(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:25:13.292 +02:00 [INF] Executed DbCommand (40ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:25:14.710 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:25:30.891 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:25:30.959 +02:00 [WRN] No store type was specified for the decimal property 'BaseFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:25:30.963 +02:00 [WRN] No store type was specified for the decimal property 'FinalFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:25:30.966 +02:00 [WRN] No store type was specified for the decimal property 'TotalDiscount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:25:30.968 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeModifier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:25:30.970 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'PromoCode'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:25:30.973 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'Tier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:25:30.975 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Transaction'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:25:30.977 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:25:30.979 +02:00 [WRN] No store type was specified for the decimal property 'FeeCharged' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:25:31.715 +02:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [BusinessHolidays] AS [b]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:25:31.757 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PaymentMethods] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:25:31.769 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PromoCodes] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:25:31.781 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Tiers] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:25:31.790 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [TransactionTypes] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:25:31.801 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:25:31.812 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Transactions] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:25:31.824 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [FeeModifiers] AS [f]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:25:32.152 +02:00 [INF] Now listening on: https://localhost:7261
2025-11-18 13:25:32.154 +02:00 [INF] Now listening on: http://localhost:5186
2025-11-18 13:25:32.269 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-18 13:25:32.271 +02:00 [INF] Hosting environment: Development
2025-11-18 13:25:32.272 +02:00 [INF] Content root path: C:\Users\User\source\repos\FeeCalculationEngine\FeeCalculationEngine.API
2025-11-18 13:25:33.533 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - null null
2025-11-18 13:25:33.931 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - 200 null text/html;charset=utf-8 418.9901ms
2025-11-18 13:25:33.933 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - null null
2025-11-18 13:25:33.958 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - 200 16533 application/javascript; charset=utf-8 25.2293ms
2025-11-18 13:25:33.962 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - null null
2025-11-18 13:25:34.055 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - 200 null text/javascript; charset=UTF-8 93.5729ms
2025-11-18 13:25:34.100 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - null null
2025-11-18 13:25:34.130 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 30.4491ms
2025-11-18 13:25:36.819 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Preview - application/json 102
2025-11-18 13:25:36.831 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Preview (FeeCalculationEngine.API)'
2025-11-18 13:25:36.862 +02:00 [INF] Route matched with {action = "Preview", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult] Preview(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:25:40.238 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Preview (FeeCalculationEngine.API) in 3365.0774ms
2025-11-18 13:25:40.242 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Preview (FeeCalculationEngine.API)'
2025-11-18 13:25:40.247 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: Invalid transaction type
   at FeeCalculationEngine.Application.Services.FeeCalculationService.CalculateBaseFee(FeeCalculationRequest request, Int32 withdrawalCount) in C:\Users\User\source\repos\FeeCalculationEngine\FeeCalculationEngine.Application\Services\FeeCalculationService.cs:line 159
   at FeeCalculationEngine.Application.Services.FeeCalculationService.CalculateFee(FeeCalculationRequest request, Int32 withdrawalCount) in C:\Users\User\source\repos\FeeCalculationEngine\FeeCalculationEngine.Application\Services\FeeCalculationService.cs:line 58
   at FeeCalculationEngine.Application.Services.FeesService.ProcessFeeCalculation(FeeCalculationRequest request, Boolean persist) in C:\Users\User\source\repos\FeeCalculationEngine\FeeCalculationEngine.Application\Services\FeesService.cs:line 46
   at FeeCalculationEngine.Application.Services.FeesService.PreviewFee(FeeCalculationRequest request) in C:\Users\User\source\repos\FeeCalculationEngine\FeeCalculationEngine.Application\Services\FeesService.cs:line 26
   at FeeCalculationEngine.API.Controllers.FeesController.Preview(FeeCalculationRequest request) in C:\Users\User\source\repos\FeeCalculationEngine\FeeCalculationEngine.API\Controllers\FeesController.cs:line 26
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-11-18 13:25:40.344 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Preview - 500 null text/plain; charset=utf-8 3525.9146ms
2025-11-18 13:35:33.034 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:33.056 +02:00 [WRN] No store type was specified for the decimal property 'BaseFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:33.056 +02:00 [WRN] No store type was specified for the decimal property 'FinalFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:33.056 +02:00 [WRN] No store type was specified for the decimal property 'TotalDiscount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:33.056 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeModifier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:33.056 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'PromoCode'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:33.056 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'Tier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:33.056 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Transaction'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:33.056 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:33.056 +02:00 [WRN] No store type was specified for the decimal property 'FeeCharged' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:33.139 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:33.139 +02:00 [WRN] No store type was specified for the decimal property 'BaseFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:33.139 +02:00 [WRN] No store type was specified for the decimal property 'FinalFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:33.139 +02:00 [WRN] No store type was specified for the decimal property 'TotalDiscount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:33.139 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeModifier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:33.139 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'PromoCode'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:33.139 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'Tier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:33.139 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Transaction'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:33.411 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:33.411 +02:00 [WRN] No store type was specified for the decimal property 'FeeCharged' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:38.614 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:38.649 +02:00 [WRN] No store type was specified for the decimal property 'BaseFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:38.649 +02:00 [WRN] No store type was specified for the decimal property 'FinalFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:38.649 +02:00 [WRN] No store type was specified for the decimal property 'TotalDiscount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:38.649 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeModifier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:38.649 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'PromoCode'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:38.649 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'Tier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:38.649 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Transaction'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:38.649 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:38.649 +02:00 [WRN] No store type was specified for the decimal property 'FeeCharged' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:39.000 +02:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-18 13:35:39.021 +02:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-18 13:35:39.023 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-18 13:35:39.103 +02:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2025-11-18 13:35:39.104 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-18 13:35:39.106 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-18 13:35:39.119 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-18 13:35:39.131 +02:00 [INF] Applying migration '20251118113533_InitialMigration'.
2025-11-18 13:35:39.189 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [BusinessHolidays] (
    [Id] int NOT NULL IDENTITY,
    [HolidaysDate] datetime2 NOT NULL,
    [Description] nvarchar(max) NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_BusinessHolidays] PRIMARY KEY ([Id])
);
2025-11-18 13:35:39.192 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [FeeModifiers] (
    [Id] int NOT NULL IDENTITY,
    [ModifierName] nvarchar(max) NOT NULL,
    [Amount] decimal(18,2) NOT NULL,
    [Priority] int NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_FeeModifiers] PRIMARY KEY ([Id])
);
2025-11-18 13:35:39.195 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [PaymentMethods] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(max) NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_PaymentMethods] PRIMARY KEY ([Id])
);
2025-11-18 13:35:39.198 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [PromoCodes] (
    [Id] int NOT NULL IDENTITY,
    [Code] nvarchar(max) NOT NULL,
    [DiscountPercentage] decimal(18,2) NOT NULL,
    [ExpiryDate] datetime2 NOT NULL,
    [IsActive] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_PromoCodes] PRIMARY KEY ([Id])
);
2025-11-18 13:35:39.202 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Tiers] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(max) NOT NULL,
    [DiscountPercentage] decimal(18,2) NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_Tiers] PRIMARY KEY ([Id])
);
2025-11-18 13:35:39.204 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [TransactionTypes] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(max) NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_TransactionTypes] PRIMARY KEY ([Id])
);
2025-11-18 13:35:39.209 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Users] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(max) NULL,
    [Email] nvarchar(max) NULL,
    [TierId] int NOT NULL,
    [IsHighVolume] bit NOT NULL,
    [IsFirstTime] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_Users] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Users_Tiers_TierId] FOREIGN KEY ([TierId]) REFERENCES [Tiers] ([Id]) ON DELETE CASCADE
);
2025-11-18 13:35:39.213 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [FeeAuditLogs] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [TransactionTypeId] int NOT NULL,
    [Amount] decimal(18,2) NOT NULL,
    [BaseFee] decimal(18,2) NOT NULL,
    [TotalDiscount] decimal(18,2) NOT NULL,
    [FinalFee] decimal(18,2) NOT NULL,
    [Breakdown] nvarchar(max) NOT NULL,
    [StackingStrategy] nvarchar(max) NOT NULL,
    [TransactionDate] datetime2 NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_FeeAuditLogs] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_FeeAuditLogs_TransactionTypes_TransactionTypeId] FOREIGN KEY ([TransactionTypeId]) REFERENCES [TransactionTypes] ([Id]) ON DELETE CASCADE
);
2025-11-18 13:35:39.556 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserTransactionHistories] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [TransactionTypeId] int NOT NULL,
    [TransactionDate] datetime2 NOT NULL,
    [Amount] decimal(18,2) NOT NULL,
    [FeeCharged] decimal(18,2) NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_UserTransactionHistories] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_UserTransactionHistories_TransactionTypes_TransactionTypeId] FOREIGN KEY ([TransactionTypeId]) REFERENCES [TransactionTypes] ([Id]) ON DELETE CASCADE
);
2025-11-18 13:35:39.564 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Transactions] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [Amount] decimal(18,2) NOT NULL,
    [TransactionTypeId] int NOT NULL,
    [PaymentMethodId] int NOT NULL,
    [PromoCodeId] int NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_Transactions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Transactions_PaymentMethods_PaymentMethodId] FOREIGN KEY ([PaymentMethodId]) REFERENCES [PaymentMethods] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Transactions_PromoCodes_PromoCodeId] FOREIGN KEY ([PromoCodeId]) REFERENCES [PromoCodes] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Transactions_TransactionTypes_TransactionTypeId] FOREIGN KEY ([TransactionTypeId]) REFERENCES [TransactionTypes] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Transactions_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-11-18 13:35:39.575 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_FeeAuditLogs_TransactionTypeId] ON [FeeAuditLogs] ([TransactionTypeId]);
2025-11-18 13:35:39.578 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Transactions_PaymentMethodId] ON [Transactions] ([PaymentMethodId]);
2025-11-18 13:35:39.580 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Transactions_PromoCodeId] ON [Transactions] ([PromoCodeId]);
2025-11-18 13:35:39.582 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Transactions_TransactionTypeId] ON [Transactions] ([TransactionTypeId]);
2025-11-18 13:35:39.584 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Transactions_UserId] ON [Transactions] ([UserId]);
2025-11-18 13:35:39.587 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Users_TierId] ON [Users] ([TierId]);
2025-11-18 13:35:39.589 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserTransactionHistories_TransactionTypeId] ON [UserTransactionHistories] ([TransactionTypeId]);
2025-11-18 13:35:39.592 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251118113533_InitialMigration', N'8.0.0');
2025-11-18 13:35:58.160 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:58.248 +02:00 [WRN] No store type was specified for the decimal property 'BaseFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:58.252 +02:00 [WRN] No store type was specified for the decimal property 'FinalFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:58.257 +02:00 [WRN] No store type was specified for the decimal property 'TotalDiscount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:58.263 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeModifier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:58.268 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'PromoCode'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:58.274 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'Tier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:58.280 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Transaction'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:58.284 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:58.289 +02:00 [WRN] No store type was specified for the decimal property 'FeeCharged' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:35:59.203 +02:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [BusinessHolidays] AS [b]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:35:59.728 +02:00 [INF] Executed DbCommand (61ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (DbType = DateTime2), @p10='?' (Size = 4000), @p11='?' (DbType = DateTime2), @p12='?' (DbType = DateTime2), @p13='?' (Size = 4000), @p14='?' (DbType = DateTime2), @p15='?' (DbType = DateTime2), @p16='?' (Size = 4000), @p17='?' (DbType = DateTime2), @p18='?' (DbType = DateTime2), @p19='?' (Size = 4000), @p20='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [BusinessHolidays] USING (
VALUES (@p0, @p1, @p2, 0),
(@p3, @p4, @p5, 1),
(@p6, @p7, @p8, 2),
(@p9, @p10, @p11, 3),
(@p12, @p13, @p14, 4),
(@p15, @p16, @p17, 5),
(@p18, @p19, @p20, 6)) AS i ([CreatedAt], [Description], [HolidaysDate], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CreatedAt], [Description], [HolidaysDate])
VALUES (i.[CreatedAt], i.[Description], i.[HolidaysDate])
OUTPUT INSERTED.[Id], i._Position;
2025-11-18 13:35:59.806 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PaymentMethods] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:35:59.865 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [PaymentMethods] USING (
VALUES (@p0, @p1, 0),
(@p2, @p3, 1),
(@p4, @p5, 2)) AS i ([CreatedAt], [Name], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CreatedAt], [Name])
VALUES (i.[CreatedAt], i.[Name])
OUTPUT INSERTED.[Id], i._Position;
2025-11-18 13:35:59.880 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PromoCodes] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:35:59.980 +02:00 [INF] Executed DbCommand (19ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Boolean), @p10='?' (Size = 4000), @p11='?' (DbType = DateTime2), @p12='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p13='?' (DbType = DateTime2), @p14='?' (DbType = Boolean), @p15='?' (Size = 4000), @p16='?' (DbType = DateTime2), @p17='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p18='?' (DbType = DateTime2), @p19='?' (DbType = Boolean), @p20='?' (Size = 4000), @p21='?' (DbType = DateTime2), @p22='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p23='?' (DbType = DateTime2), @p24='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [PromoCodes] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, 0),
(@p5, @p6, @p7, @p8, @p9, 1),
(@p10, @p11, @p12, @p13, @p14, 2),
(@p15, @p16, @p17, @p18, @p19, 3),
(@p20, @p21, @p22, @p23, @p24, 4)) AS i ([Code], [CreatedAt], [DiscountPercentage], [ExpiryDate], [IsActive], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([Code], [CreatedAt], [DiscountPercentage], [ExpiryDate], [IsActive])
VALUES (i.[Code], i.[CreatedAt], i.[DiscountPercentage], i.[ExpiryDate], i.[IsActive])
OUTPUT INSERTED.[Id], i._Position;
2025-11-18 13:36:00.004 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Tiers] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:36:00.050 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [Tiers] USING (
VALUES (@p0, @p1, @p2, 0),
(@p3, @p4, @p5, 1)) AS i ([CreatedAt], [DiscountPercentage], [Name], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CreatedAt], [DiscountPercentage], [Name])
VALUES (i.[CreatedAt], i.[DiscountPercentage], i.[Name])
OUTPUT INSERTED.[Id], i._Position;
2025-11-18 13:36:00.072 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [TransactionTypes] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:36:00.114 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [TransactionTypes] USING (
VALUES (@p0, @p1, 0),
(@p2, @p3, 1),
(@p4, @p5, 2),
(@p6, @p7, 3)) AS i ([CreatedAt], [Name], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CreatedAt], [Name])
VALUES (i.[CreatedAt], i.[Name])
OUTPUT INSERTED.[Id], i._Position;
2025-11-18 13:36:00.128 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:36:00.205 +02:00 [INF] Executed DbCommand (24ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (DbType = Boolean), @p3='?' (DbType = Boolean), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = Boolean), @p9='?' (DbType = Boolean), @p10='?' (Size = 4000), @p11='?' (DbType = Int32), @p12='?' (DbType = DateTime2), @p13='?' (Size = 4000), @p14='?' (DbType = Boolean), @p15='?' (DbType = Boolean), @p16='?' (Size = 4000), @p17='?' (DbType = Int32), @p18='?' (DbType = DateTime2), @p19='?' (Size = 4000), @p20='?' (DbType = Boolean), @p21='?' (DbType = Boolean), @p22='?' (Size = 4000), @p23='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [Users] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, 0),
(@p6, @p7, @p8, @p9, @p10, @p11, 1),
(@p12, @p13, @p14, @p15, @p16, @p17, 2),
(@p18, @p19, @p20, @p21, @p22, @p23, 3)) AS i ([CreatedAt], [Email], [IsFirstTime], [IsHighVolume], [Name], [TierId], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CreatedAt], [Email], [IsFirstTime], [IsHighVolume], [Name], [TierId])
VALUES (i.[CreatedAt], i.[Email], i.[IsFirstTime], i.[IsHighVolume], i.[Name], i.[TierId])
OUTPUT INSERTED.[Id], i._Position;
2025-11-18 13:36:00.233 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Transactions] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:36:00.307 +02:00 [INF] Executed DbCommand (38ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p13='?' (DbType = DateTime2), @p14='?' (DbType = Int32), @p15='?' (DbType = Int32), @p16='?' (DbType = Int32), @p17='?' (DbType = Int32), @p18='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p19='?' (DbType = DateTime2), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (DbType = Int32), @p23='?' (DbType = Int32), @p24='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p25='?' (DbType = DateTime2), @p26='?' (DbType = Int32), @p27='?' (DbType = Int32), @p28='?' (DbType = Int32), @p29='?' (DbType = Int32), @p30='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p31='?' (DbType = DateTime2), @p32='?' (DbType = Int32), @p33='?' (DbType = Int32), @p34='?' (DbType = Int32), @p35='?' (DbType = Int32), @p36='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p37='?' (DbType = DateTime2), @p38='?' (DbType = Int32), @p39='?' (DbType = Int32), @p40='?' (DbType = Int32), @p41='?' (DbType = Int32), @p42='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p43='?' (DbType = DateTime2), @p44='?' (DbType = Int32), @p45='?' (DbType = Int32), @p46='?' (DbType = Int32), @p47='?' (DbType = Int32), @p48='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p49='?' (DbType = DateTime2), @p50='?' (DbType = Int32), @p51='?' (DbType = Int32), @p52='?' (DbType = Int32), @p53='?' (DbType = Int32), @p54='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p55='?' (DbType = DateTime2), @p56='?' (DbType = Int32), @p57='?' (DbType = Int32), @p58='?' (DbType = Int32), @p59='?' (DbType = Int32), @p60='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p61='?' (DbType = DateTime2), @p62='?' (DbType = Int32), @p63='?' (DbType = Int32), @p64='?' (DbType = Int32), @p65='?' (DbType = Int32), @p66='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p67='?' (DbType = DateTime2), @p68='?' (DbType = Int32), @p69='?' (DbType = Int32), @p70='?' (DbType = Int32), @p71='?' (DbType = Int32), @p72='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p73='?' (DbType = DateTime2), @p74='?' (DbType = Int32), @p75='?' (DbType = Int32), @p76='?' (DbType = Int32), @p77='?' (DbType = Int32), @p78='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p79='?' (DbType = DateTime2), @p80='?' (DbType = Int32), @p81='?' (DbType = Int32), @p82='?' (DbType = Int32), @p83='?' (DbType = Int32), @p84='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p85='?' (DbType = DateTime2), @p86='?' (DbType = Int32), @p87='?' (DbType = Int32), @p88='?' (DbType = Int32), @p89='?' (DbType = Int32), @p90='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p91='?' (DbType = DateTime2), @p92='?' (DbType = Int32), @p93='?' (DbType = Int32), @p94='?' (DbType = Int32), @p95='?' (DbType = Int32), @p96='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p97='?' (DbType = DateTime2), @p98='?' (DbType = Int32), @p99='?' (DbType = Int32), @p100='?' (DbType = Int32), @p101='?' (DbType = Int32), @p102='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p103='?' (DbType = DateTime2), @p104='?' (DbType = Int32), @p105='?' (DbType = Int32), @p106='?' (DbType = Int32), @p107='?' (DbType = Int32), @p108='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p109='?' (DbType = DateTime2), @p110='?' (DbType = Int32), @p111='?' (DbType = Int32), @p112='?' (DbType = Int32), @p113='?' (DbType = Int32), @p114='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p115='?' (DbType = DateTime2), @p116='?' (DbType = Int32), @p117='?' (DbType = Int32), @p118='?' (DbType = Int32), @p119='?' (DbType = Int32), @p120='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p121='?' (DbType = DateTime2), @p122='?' (DbType = Int32), @p123='?' (DbType = Int32), @p124='?' (DbType = Int32), @p125='?' (DbType = Int32), @p126='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p127='?' (DbType = DateTime2), @p128='?' (DbType = Int32), @p129='?' (DbType = Int32), @p130='?' (DbType = Int32), @p131='?' (DbType = Int32), @p132='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p133='?' (DbType = DateTime2), @p134='?' (DbType = Int32), @p135='?' (DbType = Int32), @p136='?' (DbType = Int32), @p137='?' (DbType = Int32), @p138='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p139='?' (DbType = DateTime2), @p140='?' (DbType = Int32), @p141='?' (DbType = Int32), @p142='?' (DbType = Int32), @p143='?' (DbType = Int32), @p144='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p145='?' (DbType = DateTime2), @p146='?' (DbType = Int32), @p147='?' (DbType = Int32), @p148='?' (DbType = Int32), @p149='?' (DbType = Int32), @p150='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p151='?' (DbType = DateTime2), @p152='?' (DbType = Int32), @p153='?' (DbType = Int32), @p154='?' (DbType = Int32), @p155='?' (DbType = Int32), @p156='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p157='?' (DbType = DateTime2), @p158='?' (DbType = Int32), @p159='?' (DbType = Int32), @p160='?' (DbType = Int32), @p161='?' (DbType = Int32), @p162='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p163='?' (DbType = DateTime2), @p164='?' (DbType = Int32), @p165='?' (DbType = Int32), @p166='?' (DbType = Int32), @p167='?' (DbType = Int32), @p168='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p169='?' (DbType = DateTime2), @p170='?' (DbType = Int32), @p171='?' (DbType = Int32), @p172='?' (DbType = Int32), @p173='?' (DbType = Int32), @p174='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p175='?' (DbType = DateTime2), @p176='?' (DbType = Int32), @p177='?' (DbType = Int32), @p178='?' (DbType = Int32), @p179='?' (DbType = Int32), @p180='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p181='?' (DbType = DateTime2), @p182='?' (DbType = Int32), @p183='?' (DbType = Int32), @p184='?' (DbType = Int32), @p185='?' (DbType = Int32), @p186='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p187='?' (DbType = DateTime2), @p188='?' (DbType = Int32), @p189='?' (DbType = Int32), @p190='?' (DbType = Int32), @p191='?' (DbType = Int32), @p192='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p193='?' (DbType = DateTime2), @p194='?' (DbType = Int32), @p195='?' (DbType = Int32), @p196='?' (DbType = Int32), @p197='?' (DbType = Int32), @p198='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p199='?' (DbType = DateTime2), @p200='?' (DbType = Int32), @p201='?' (DbType = Int32), @p202='?' (DbType = Int32), @p203='?' (DbType = Int32), @p204='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p205='?' (DbType = DateTime2), @p206='?' (DbType = Int32), @p207='?' (DbType = Int32), @p208='?' (DbType = Int32), @p209='?' (DbType = Int32), @p210='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p211='?' (DbType = DateTime2), @p212='?' (DbType = Int32), @p213='?' (DbType = Int32), @p214='?' (DbType = Int32), @p215='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [Transactions] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, 0),
(@p6, @p7, @p8, @p9, @p10, @p11, 1),
(@p12, @p13, @p14, @p15, @p16, @p17, 2),
(@p18, @p19, @p20, @p21, @p22, @p23, 3),
(@p24, @p25, @p26, @p27, @p28, @p29, 4),
(@p30, @p31, @p32, @p33, @p34, @p35, 5),
(@p36, @p37, @p38, @p39, @p40, @p41, 6),
(@p42, @p43, @p44, @p45, @p46, @p47, 7),
(@p48, @p49, @p50, @p51, @p52, @p53, 8),
(@p54, @p55, @p56, @p57, @p58, @p59, 9),
(@p60, @p61, @p62, @p63, @p64, @p65, 10),
(@p66, @p67, @p68, @p69, @p70, @p71, 11),
(@p72, @p73, @p74, @p75, @p76, @p77, 12),
(@p78, @p79, @p80, @p81, @p82, @p83, 13),
(@p84, @p85, @p86, @p87, @p88, @p89, 14),
(@p90, @p91, @p92, @p93, @p94, @p95, 15),
(@p96, @p97, @p98, @p99, @p100, @p101, 16),
(@p102, @p103, @p104, @p105, @p106, @p107, 17),
(@p108, @p109, @p110, @p111, @p112, @p113, 18),
(@p114, @p115, @p116, @p117, @p118, @p119, 19),
(@p120, @p121, @p122, @p123, @p124, @p125, 20),
(@p126, @p127, @p128, @p129, @p130, @p131, 21),
(@p132, @p133, @p134, @p135, @p136, @p137, 22),
(@p138, @p139, @p140, @p141, @p142, @p143, 23),
(@p144, @p145, @p146, @p147, @p148, @p149, 24),
(@p150, @p151, @p152, @p153, @p154, @p155, 25),
(@p156, @p157, @p158, @p159, @p160, @p161, 26),
(@p162, @p163, @p164, @p165, @p166, @p167, 27),
(@p168, @p169, @p170, @p171, @p172, @p173, 28),
(@p174, @p175, @p176, @p177, @p178, @p179, 29),
(@p180, @p181, @p182, @p183, @p184, @p185, 30),
(@p186, @p187, @p188, @p189, @p190, @p191, 31),
(@p192, @p193, @p194, @p195, @p196, @p197, 32),
(@p198, @p199, @p200, @p201, @p202, @p203, 33),
(@p204, @p205, @p206, @p207, @p208, @p209, 34),
(@p210, @p211, @p212, @p213, @p214, @p215, 35)) AS i ([Amount], [CreatedAt], [PaymentMethodId], [PromoCodeId], [TransactionTypeId], [UserId], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([Amount], [CreatedAt], [PaymentMethodId], [PromoCodeId], [TransactionTypeId], [UserId])
VALUES (i.[Amount], i.[CreatedAt], i.[PaymentMethodId], i.[PromoCodeId], i.[TransactionTypeId], i.[UserId])
OUTPUT INSERTED.[Id], i._Position;
2025-11-18 13:36:00.334 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [FeeModifiers] AS [f]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:36:00.382 +02:00 [INF] Executed DbCommand (14ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p9='?' (DbType = DateTime2), @p10='?' (Size = 4000), @p11='?' (DbType = Int32), @p12='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p13='?' (DbType = DateTime2), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p17='?' (DbType = DateTime2), @p18='?' (Size = 4000), @p19='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [FeeModifiers] USING (
VALUES (@p0, @p1, @p2, @p3, 0),
(@p4, @p5, @p6, @p7, 1),
(@p8, @p9, @p10, @p11, 2),
(@p12, @p13, @p14, @p15, 3),
(@p16, @p17, @p18, @p19, 4)) AS i ([Amount], [CreatedAt], [ModifierName], [Priority], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([Amount], [CreatedAt], [ModifierName], [Priority])
VALUES (i.[Amount], i.[CreatedAt], i.[ModifierName], i.[Priority])
OUTPUT INSERTED.[Id], i._Position;
2025-11-18 13:36:00.812 +02:00 [INF] Now listening on: https://localhost:7261
2025-11-18 13:36:00.820 +02:00 [INF] Now listening on: http://localhost:5186
2025-11-18 13:36:00.912 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-18 13:36:00.916 +02:00 [INF] Hosting environment: Development
2025-11-18 13:36:00.919 +02:00 [INF] Content root path: C:\Users\User\source\repos\FeeCalculationEngine\FeeCalculationEngine.API
2025-11-18 13:36:01.785 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - null null
2025-11-18 13:36:02.266 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - 200 null text/html;charset=utf-8 512.8596ms
2025-11-18 13:36:02.355 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - null null
2025-11-18 13:36:02.355 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - null null
2025-11-18 13:36:02.374 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - 200 16533 application/javascript; charset=utf-8 19.6415ms
2025-11-18 13:36:02.481 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - 200 null text/javascript; charset=UTF-8 126.8527ms
2025-11-18 13:36:02.527 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - null null
2025-11-18 13:36:02.565 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 39.2795ms
2025-11-18 13:36:25.513 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:36:25.563 +02:00 [WRN] No store type was specified for the decimal property 'BaseFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:36:25.564 +02:00 [WRN] No store type was specified for the decimal property 'FinalFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:36:25.565 +02:00 [WRN] No store type was specified for the decimal property 'TotalDiscount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:36:25.566 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeModifier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:36:25.567 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'PromoCode'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:36:25.569 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'Tier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:36:25.570 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Transaction'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:36:25.572 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:36:25.573 +02:00 [WRN] No store type was specified for the decimal property 'FeeCharged' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:36:26.163 +02:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [BusinessHolidays] AS [b]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:36:26.192 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PaymentMethods] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:36:26.201 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PromoCodes] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:36:26.209 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Tiers] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:36:26.216 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [TransactionTypes] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:36:26.227 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:36:26.239 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Transactions] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:36:26.250 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [FeeModifiers] AS [f]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:36:26.507 +02:00 [INF] Now listening on: https://localhost:7261
2025-11-18 13:36:26.509 +02:00 [INF] Now listening on: http://localhost:5186
2025-11-18 13:36:26.598 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-18 13:36:26.603 +02:00 [INF] Hosting environment: Development
2025-11-18 13:36:26.604 +02:00 [INF] Content root path: C:\Users\User\source\repos\FeeCalculationEngine\FeeCalculationEngine.API
2025-11-18 13:36:27.335 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - null null
2025-11-18 13:36:27.780 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - 200 null text/html;charset=utf-8 473.1089ms
2025-11-18 13:36:27.854 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - null null
2025-11-18 13:36:27.854 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - null null
2025-11-18 13:36:27.875 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - 200 16533 application/javascript; charset=utf-8 21.75ms
2025-11-18 13:36:27.952 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - 200 null text/javascript; charset=UTF-8 99.2496ms
2025-11-18 13:36:28.007 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - null null
2025-11-18 13:36:28.053 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 46.8471ms
2025-11-18 13:36:37.296 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:36:37.313 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:36:37.366 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:36:37.632 +02:00 [INF] Executed DbCommand (37ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:36:37.840 +02:00 [INF] Executed DbCommand (16ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:36:38.031 +02:00 [INF] Executed DbCommand (12ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:36:38.059 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:36:38.113 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CONVERT(date, [b].[HolidaysDate])
FROM [BusinessHolidays] AS [b]
2025-11-18 13:36:38.135 +02:00 [INF] Final fee: 0, Discount: 15.00000
2025-11-18 13:36:38.444 +02:00 [INF] Executed DbCommand (56ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:36:38.568 +02:00 [INF] Executed DbCommand (20ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:36:38.583 +02:00 [INF] Transaction persisted for UserId 1: TransactionRequest { UserId = 1, TransactionTypeId = 1, Amount = 1000.00, Fee = 0 }
2025-11-18 13:36:38.604 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:36:38.632 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 1257.161ms
2025-11-18 13:36:38.636 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:36:38.650 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 1354.4148ms
2025-11-18 13:36:43.411 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:36:43.420 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:36:43.422 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:36:43.451 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:36:43.461 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:36:43.472 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:36:43.479 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:36:43.486 +02:00 [INF] Final fee: 13.07, Discount: 7.431250000
2025-11-18 13:36:43.493 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:36:43.499 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:36:43.502 +02:00 [INF] Transaction persisted for UserId 1: TransactionRequest { UserId = 1, TransactionTypeId = 1, Amount = 1100.00, Fee = 13.07 }
2025-11-18 13:36:43.504 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:36:43.506 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 81.5226ms
2025-11-18 13:36:43.508 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:36:43.510 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 99.1345ms
2025-11-18 13:36:46.911 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:36:46.917 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:36:46.919 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:36:46.934 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:36:46.941 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:36:46.952 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:36:46.960 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:36:46.965 +02:00 [INF] Final fee: 11.81, Discount: 9.187500000
2025-11-18 13:36:46.974 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:36:46.979 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:36:46.982 +02:00 [INF] Transaction persisted for UserId 1: TransactionRequest { UserId = 1, TransactionTypeId = 1, Amount = 1200.00, Fee = 11.81 }
2025-11-18 13:36:46.984 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:36:46.986 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 64.1587ms
2025-11-18 13:36:46.989 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:36:46.991 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 80.2921ms
2025-11-18 13:36:50.846 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:36:50.853 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:36:50.857 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:36:50.863 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:36:50.865 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:36:50.870 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:36:50.876 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:36:50.880 +02:00 [INF] Final fee: 14.51, Discount: 6.987500000
2025-11-18 13:36:50.886 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:36:50.894 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:36:50.896 +02:00 [INF] Transaction persisted for UserId 1: TransactionRequest { UserId = 1, TransactionTypeId = 1, Amount = 1300.00, Fee = 14.51 }
2025-11-18 13:36:50.898 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:36:50.900 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 40.0331ms
2025-11-18 13:36:50.902 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:36:50.904 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 57.9245ms
2025-11-18 13:36:54.334 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:36:54.341 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:36:54.342 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:36:54.347 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:36:54.351 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:36:54.359 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:36:54.362 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:36:54.366 +02:00 [INF] Final fee: 14.02, Discount: 7.975000000
2025-11-18 13:36:54.373 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:36:54.381 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:36:54.384 +02:00 [INF] Transaction persisted for UserId 1: TransactionRequest { UserId = 1, TransactionTypeId = 1, Amount = 1400.00, Fee = 14.02 }
2025-11-18 13:36:54.385 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:36:54.388 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 42.9345ms
2025-11-18 13:36:54.389 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:36:54.391 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 57.7019ms
2025-11-18 13:36:58.087 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:36:58.092 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:36:58.094 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:36:58.097 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:36:58.101 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:36:58.108 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:36:58.112 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:36:58.114 +02:00 [INF] Final fee: 12.66, Discount: 9.843750000
2025-11-18 13:36:58.117 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:36:58.123 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:36:58.126 +02:00 [INF] Transaction persisted for UserId 1: TransactionRequest { UserId = 1, TransactionTypeId = 1, Amount = 1500.00, Fee = 12.66 }
2025-11-18 13:36:58.128 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:36:58.130 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 34.5588ms
2025-11-18 13:36:58.132 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:36:58.134 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 47.3115ms
2025-11-18 13:37:01.540 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:37:01.543 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:01.545 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:37:01.549 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:37:01.552 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:37:01.558 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:37:01.561 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:37:01.563 +02:00 [INF] Final fee: 15.52, Discount: 7.475000000
2025-11-18 13:37:01.566 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:37:01.572 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:37:01.574 +02:00 [INF] Transaction persisted for UserId 1: TransactionRequest { UserId = 1, TransactionTypeId = 1, Amount = 1600.00, Fee = 15.52 }
2025-11-18 13:37:01.576 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:37:01.577 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 30.6765ms
2025-11-18 13:37:01.579 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:01.581 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 41.2934ms
2025-11-18 13:37:04.792 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:37:04.795 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:04.796 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:37:04.800 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:37:04.803 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:37:04.807 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:37:04.810 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:37:04.813 +02:00 [INF] Final fee: 14.98, Discount: 8.518750000
2025-11-18 13:37:04.820 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:37:04.827 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:37:04.832 +02:00 [INF] Transaction persisted for UserId 1: TransactionRequest { UserId = 1, TransactionTypeId = 1, Amount = 1700.00, Fee = 14.98 }
2025-11-18 13:37:04.835 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:37:04.839 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 40.6051ms
2025-11-18 13:37:04.842 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:04.844 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 52.6391ms
2025-11-18 13:37:07.862 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:37:07.867 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:07.869 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:37:07.873 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:37:07.877 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:37:07.880 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:37:07.884 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:37:07.887 +02:00 [INF] Final fee: 13.50, Discount: 10.500000000
2025-11-18 13:37:07.895 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:37:07.898 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:37:07.902 +02:00 [INF] Transaction persisted for UserId 1: TransactionRequest { UserId = 1, TransactionTypeId = 1, Amount = 1800.00, Fee = 13.50 }
2025-11-18 13:37:07.903 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:37:07.905 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 33.8359ms
2025-11-18 13:37:07.907 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:07.908 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 46.422ms
2025-11-18 13:37:15.906 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:37:15.913 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:15.914 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:37:15.919 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:37:15.926 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:37:15.930 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:37:15.933 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:37:15.936 +02:00 [INF] Final fee: 0, Discount: 65.0000
2025-11-18 13:37:15.943 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:37:15.947 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:37:15.950 +02:00 [INF] Transaction persisted for UserId 2: TransactionRequest { UserId = 2, TransactionTypeId = 2, Amount = 2000.00, Fee = 0 }
2025-11-18 13:37:15.951 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:37:15.953 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 37.2747ms
2025-11-18 13:37:15.955 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:15.957 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 51.8046ms
2025-11-18 13:37:19.066 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:37:19.075 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:19.077 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:37:19.081 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:37:19.086 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:37:19.089 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:37:19.093 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:37:19.099 +02:00 [INF] Final fee: 43.35, Discount: 24.65000000
2025-11-18 13:37:19.107 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:37:19.116 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:37:19.118 +02:00 [INF] Transaction persisted for UserId 2: TransactionRequest { UserId = 2, TransactionTypeId = 2, Amount = 2100.00, Fee = 43.35 }
2025-11-18 13:37:19.121 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:37:19.124 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 44.9807ms
2025-11-18 13:37:19.126 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:19.127 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 61.2315ms
2025-11-18 13:37:22.728 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:37:22.735 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:22.737 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:37:22.742 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:37:22.745 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:37:22.749 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:37:22.753 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:37:22.756 +02:00 [INF] Final fee: 39.94, Discount: 31.06250000
2025-11-18 13:37:22.761 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:37:22.766 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:37:22.768 +02:00 [INF] Transaction persisted for UserId 2: TransactionRequest { UserId = 2, TransactionTypeId = 2, Amount = 2200.00, Fee = 39.94 }
2025-11-18 13:37:22.770 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:37:22.772 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 31.766ms
2025-11-18 13:37:22.773 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:22.775 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 47.4733ms
2025-11-18 13:37:25.842 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:37:25.847 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:25.849 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:37:25.854 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:37:25.857 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:37:25.860 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:37:25.863 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:37:25.865 +02:00 [INF] Final fee: 49.95, Discount: 24.05000000
2025-11-18 13:37:25.871 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:37:25.875 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:37:25.877 +02:00 [INF] Transaction persisted for UserId 2: TransactionRequest { UserId = 2, TransactionTypeId = 2, Amount = 2300.00, Fee = 49.95 }
2025-11-18 13:37:25.879 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:37:25.880 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 28.8505ms
2025-11-18 13:37:25.882 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:25.883 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 42.0244ms
2025-11-18 13:37:28.983 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:37:28.991 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:28.993 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:37:28.997 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:37:29.001 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:37:29.011 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:37:29.015 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:37:29.017 +02:00 [INF] Final fee: 49.09, Discount: 27.91250000
2025-11-18 13:37:29.024 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:37:29.029 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:37:29.033 +02:00 [INF] Transaction persisted for UserId 2: TransactionRequest { UserId = 2, TransactionTypeId = 2, Amount = 2400.00, Fee = 49.09 }
2025-11-18 13:37:29.035 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:37:29.037 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 41.1195ms
2025-11-18 13:37:29.039 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:29.041 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 59.202ms
2025-11-18 13:37:33.379 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:37:33.387 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:33.389 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:37:33.393 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:37:33.397 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:37:33.400 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:37:33.405 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:37:33.407 +02:00 [INF] Final fee: 45.00, Discount: 35.00000000
2025-11-18 13:37:33.415 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:37:33.419 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:37:33.424 +02:00 [INF] Transaction persisted for UserId 2: TransactionRequest { UserId = 2, TransactionTypeId = 2, Amount = 2500.00, Fee = 45.00 }
2025-11-18 13:37:33.425 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:37:33.427 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 35.4193ms
2025-11-18 13:37:33.428 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:33.429 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 50.3642ms
2025-11-18 13:37:36.405 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:37:36.411 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:36.412 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:37:36.416 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:37:36.420 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:37:36.423 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:37:36.426 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:37:36.428 +02:00 [INF] Final fee: 56.02, Discount: 26.97500000
2025-11-18 13:37:36.435 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:37:36.439 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:37:36.441 +02:00 [INF] Transaction persisted for UserId 2: TransactionRequest { UserId = 2, TransactionTypeId = 2, Amount = 2600.00, Fee = 56.02 }
2025-11-18 13:37:36.443 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:37:36.444 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 29.644ms
2025-11-18 13:37:36.445 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:36.446 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 41.0455ms
2025-11-18 13:37:39.284 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:37:39.289 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:39.291 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:37:39.297 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:37:39.310 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:37:39.319 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:37:39.327 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:37:39.332 +02:00 [INF] Final fee: 54.82, Discount: 31.17500000
2025-11-18 13:37:39.338 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:37:39.346 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:37:39.349 +02:00 [INF] Transaction persisted for UserId 2: TransactionRequest { UserId = 2, TransactionTypeId = 2, Amount = 2700.00, Fee = 54.82 }
2025-11-18 13:37:39.351 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:37:39.354 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 58.7199ms
2025-11-18 13:37:39.356 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:39.358 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 74.4864ms
2025-11-18 13:37:42.548 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:37:42.555 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:42.557 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:37:42.565 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:37:42.580 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:37:42.586 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:37:42.592 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:37:42.596 +02:00 [INF] Final fee: 50.06, Discount: 38.93750000
2025-11-18 13:37:42.605 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:37:42.614 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:37:42.618 +02:00 [INF] Transaction persisted for UserId 2: TransactionRequest { UserId = 2, TransactionTypeId = 2, Amount = 2800.00, Fee = 50.06 }
2025-11-18 13:37:42.620 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:37:42.623 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 63.0413ms
2025-11-18 13:37:42.625 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:42.627 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 79.2276ms
2025-11-18 13:37:46.126 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:37:46.131 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:46.133 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:37:46.163 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionTypeId] = 3 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:37:46.171 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:37:46.182 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:37:46.188 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:37:46.196 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:37:46.199 +02:00 [INF] Final fee: 0, Discount: 0
2025-11-18 13:37:46.209 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:37:46.216 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:37:46.218 +02:00 [INF] Transaction persisted for UserId 3: TransactionRequest { UserId = 3, TransactionTypeId = 3, Amount = 3000.00, Fee = 0 }
2025-11-18 13:37:46.222 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:37:46.223 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 87.2112ms
2025-11-18 13:37:46.225 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:46.226 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 101.369ms
2025-11-18 13:37:49.579 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:37:49.586 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:49.589 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:37:49.594 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionTypeId] = 3 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:37:49.598 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:37:49.601 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:37:49.605 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:37:49.608 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:37:49.611 +02:00 [INF] Final fee: 0, Discount: 0
2025-11-18 13:37:49.617 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:37:49.621 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:37:49.624 +02:00 [INF] Transaction persisted for UserId 3: TransactionRequest { UserId = 3, TransactionTypeId = 3, Amount = 3100.00, Fee = 0 }
2025-11-18 13:37:49.626 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:37:49.627 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 35.2462ms
2025-11-18 13:37:49.629 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:49.632 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 55.1159ms
2025-11-18 13:37:53.048 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:37:53.057 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:53.059 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:37:53.063 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionTypeId] = 3 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:37:53.067 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:37:53.071 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:37:53.075 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:37:53.078 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:37:53.081 +02:00 [INF] Final fee: 0, Discount: 0
2025-11-18 13:37:53.090 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:37:53.094 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:37:53.097 +02:00 [INF] Transaction persisted for UserId 3: TransactionRequest { UserId = 3, TransactionTypeId = 3, Amount = 3200.00, Fee = 0 }
2025-11-18 13:37:53.099 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:37:53.103 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 41.6749ms
2025-11-18 13:37:53.104 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:53.106 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 57.9052ms
2025-11-18 13:37:56.294 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:37:56.300 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:56.303 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:37:56.315 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionTypeId] = 3 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:37:56.320 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:37:56.324 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:37:56.327 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:37:56.330 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:37:56.333 +02:00 [INF] Final fee: 2.25, Discount: 0.2500
2025-11-18 13:37:56.337 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:37:56.343 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:37:56.346 +02:00 [INF] Transaction persisted for UserId 3: TransactionRequest { UserId = 3, TransactionTypeId = 3, Amount = 3300.00, Fee = 2.25 }
2025-11-18 13:37:56.348 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:37:56.350 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 42.5793ms
2025-11-18 13:37:56.351 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:56.354 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 60.5245ms
2025-11-18 13:37:59.888 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:37:59.896 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:59.897 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:37:59.902 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionTypeId] = 3 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:37:59.905 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:37:59.908 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:37:59.911 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:37:59.914 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:37:59.918 +02:00 [INF] Final fee: 2.12, Discount: 0.3750
2025-11-18 13:37:59.925 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:37:59.930 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:37:59.932 +02:00 [INF] Transaction persisted for UserId 3: TransactionRequest { UserId = 3, TransactionTypeId = 3, Amount = 3400.00, Fee = 2.12 }
2025-11-18 13:37:59.934 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:37:59.936 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 35.8695ms
2025-11-18 13:37:59.937 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:37:59.939 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 51.3753ms
2025-11-18 13:38:03.425 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:38:03.431 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:38:03.434 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:38:03.439 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionTypeId] = 3 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:38:03.446 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:38:03.448 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:38:03.450 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:38:03.453 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:38:03.455 +02:00 [INF] Final fee: 1.88, Discount: 0.6250
2025-11-18 13:38:03.461 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:38:03.463 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:38:03.466 +02:00 [INF] Transaction persisted for UserId 3: TransactionRequest { UserId = 3, TransactionTypeId = 3, Amount = 5000.00, Fee = 1.88 }
2025-11-18 13:38:03.467 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:38:03.470 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 33.5611ms
2025-11-18 13:38:03.471 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:38:03.473 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 48.4732ms
2025-11-18 13:38:06.861 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:38:06.865 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:38:06.866 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:38:06.872 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionTypeId] = 3 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:38:06.876 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:38:06.879 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:38:06.883 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:38:06.886 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:38:06.889 +02:00 [INF] Final fee: 3.60, Discount: 0.4000
2025-11-18 13:38:06.897 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:38:06.901 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:38:06.903 +02:00 [INF] Transaction persisted for UserId 3: TransactionRequest { UserId = 3, TransactionTypeId = 3, Amount = 6000.00, Fee = 3.60 }
2025-11-18 13:38:06.904 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:38:06.906 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 37.3162ms
2025-11-18 13:38:06.908 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:38:06.910 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 48.4833ms
2025-11-18 13:38:10.349 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:38:10.356 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:38:10.357 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:38:10.361 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionTypeId] = 3 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:38:10.364 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:38:10.366 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:38:10.375 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:38:10.379 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:38:10.383 +02:00 [INF] Final fee: 3.40, Discount: 0.6000
2025-11-18 13:38:10.393 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:38:10.398 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:38:10.402 +02:00 [INF] Transaction persisted for UserId 3: TransactionRequest { UserId = 3, TransactionTypeId = 3, Amount = 7000.00, Fee = 3.40 }
2025-11-18 13:38:10.404 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:38:10.406 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 46.1494ms
2025-11-18 13:38:10.407 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:38:10.409 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 60.11ms
2025-11-18 13:38:13.648 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:38:13.653 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:38:13.655 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:38:13.659 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionTypeId] = 3 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:38:13.662 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:38:13.665 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:38:13.669 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:38:13.672 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:38:13.675 +02:00 [INF] Final fee: 3.00, Discount: 1.0000
2025-11-18 13:38:13.682 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:38:13.686 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:38:13.689 +02:00 [INF] Transaction persisted for UserId 3: TransactionRequest { UserId = 3, TransactionTypeId = 3, Amount = 8000.00, Fee = 3.00 }
2025-11-18 13:38:13.691 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:38:13.692 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 35.5773ms
2025-11-18 13:38:13.694 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:38:13.695 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 47.6418ms
2025-11-18 13:38:28.860 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:38:28.871 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:38:28.873 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:38:28.877 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:38:28.882 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:38:28.886 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:38:28.890 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:38:28.893 +02:00 [INF] Final fee: 0, Discount: 0
2025-11-18 13:38:28.900 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:38:28.905 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:38:28.908 +02:00 [INF] Transaction persisted for UserId 4: TransactionRequest { UserId = 4, TransactionTypeId = 4, Amount = 4000.00, Fee = 0 }
2025-11-18 13:38:28.910 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:38:28.913 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 37.7602ms
2025-11-18 13:38:28.914 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:38:28.915 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 55.1637ms
2025-11-18 13:38:33.527 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:38:33.534 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:38:33.536 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:38:33.541 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:38:33.543 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:38:33.546 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:38:33.551 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:38:33.558 +02:00 [INF] Final fee: 0, Discount: 0
2025-11-18 13:38:33.566 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:38:33.571 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:38:33.573 +02:00 [INF] Transaction persisted for UserId 4: TransactionRequest { UserId = 4, TransactionTypeId = 4, Amount = 4100.00, Fee = 0 }
2025-11-18 13:38:33.575 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:38:33.577 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 37.9946ms
2025-11-18 13:38:33.578 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:38:33.579 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 52.5175ms
2025-11-18 13:38:37.036 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:38:37.039 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:38:37.041 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:38:37.045 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:38:37.048 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:38:37.055 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:38:37.058 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:38:37.061 +02:00 [INF] Final fee: 0, Discount: 0
2025-11-18 13:38:37.065 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:38:37.072 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:38:37.075 +02:00 [INF] Transaction persisted for UserId 4: TransactionRequest { UserId = 4, TransactionTypeId = 4, Amount = 4200.00, Fee = 0 }
2025-11-18 13:38:37.077 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:38:37.079 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 35.9281ms
2025-11-18 13:38:37.081 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:38:37.083 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 47.7648ms
2025-11-18 13:38:40.794 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:38:40.800 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:38:40.803 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:38:40.808 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:38:40.811 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:38:40.815 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:38:40.820 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:38:40.823 +02:00 [INF] Final fee: 16.88, Discount: 8.1250
2025-11-18 13:38:40.832 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:38:40.837 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:38:40.839 +02:00 [INF] Transaction persisted for UserId 4: TransactionRequest { UserId = 4, TransactionTypeId = 4, Amount = 4300.00, Fee = 16.88 }
2025-11-18 13:38:40.841 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:38:40.843 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 37.161ms
2025-11-18 13:38:40.845 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:38:40.846 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 53.2382ms
2025-11-18 13:38:43.811 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:38:43.818 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:38:43.821 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:38:43.826 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:38:43.829 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:38:43.833 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:38:43.837 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:38:43.840 +02:00 [INF] Final fee: 15.94, Discount: 9.0625
2025-11-18 13:38:43.848 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:38:43.854 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:38:43.857 +02:00 [INF] Transaction persisted for UserId 4: TransactionRequest { UserId = 4, TransactionTypeId = 4, Amount = 4400.00, Fee = 15.94 }
2025-11-18 13:38:43.859 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:38:43.860 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 36.4803ms
2025-11-18 13:38:43.862 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:38:43.863 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 52.3992ms
2025-11-18 13:38:47.222 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:38:47.231 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:38:47.233 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:38:47.243 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:38:47.257 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:38:47.264 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:38:47.271 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:38:47.274 +02:00 [INF] Final fee: 14.06, Discount: 10.9375
2025-11-18 13:38:47.281 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:38:47.290 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:38:47.293 +02:00 [INF] Transaction persisted for UserId 4: TransactionRequest { UserId = 4, TransactionTypeId = 4, Amount = 4500.00, Fee = 14.06 }
2025-11-18 13:38:47.295 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:38:47.296 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 59.6137ms
2025-11-18 13:38:47.298 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:38:47.300 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 77.276ms
2025-11-18 13:38:51.520 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:38:51.529 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:38:51.531 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:38:51.540 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:38:51.553 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:38:51.559 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:38:51.564 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:38:51.567 +02:00 [INF] Final fee: 0, Discount: 0
2025-11-18 13:38:51.573 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:38:51.580 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:38:51.583 +02:00 [INF] Transaction persisted for UserId 4: TransactionRequest { UserId = 4, TransactionTypeId = 4, Amount = 4600.00, Fee = 0 }
2025-11-18 13:38:51.586 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:38:51.589 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 55.7285ms
2025-11-18 13:38:51.590 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:38:51.592 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 71.909ms
2025-11-18 13:38:55.591 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:38:55.600 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:38:55.603 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:38:55.607 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:38:55.610 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:38:55.614 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:38:55.617 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:38:55.620 +02:00 [INF] Final fee: 0, Discount: 0
2025-11-18 13:38:55.627 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:38:55.631 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:38:55.634 +02:00 [INF] Transaction persisted for UserId 4: TransactionRequest { UserId = 4, TransactionTypeId = 4, Amount = 4700.00, Fee = 0 }
2025-11-18 13:38:55.636 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:38:55.638 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 32.0728ms
2025-11-18 13:38:55.640 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:38:55.641 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 50.0329ms
2025-11-18 13:39:00.026 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:39:00.035 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:39:00.037 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:39:00.042 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:39:00.045 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:39:00.052 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:39:00.056 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:39:00.059 +02:00 [INF] Final fee: 0, Discount: 0
2025-11-18 13:39:00.065 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:39:00.070 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:39:00.073 +02:00 [INF] Transaction persisted for UserId 4: TransactionRequest { UserId = 4, TransactionTypeId = 4, Amount = 4800.00, Fee = 0 }
2025-11-18 13:39:00.074 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:39:00.076 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 34.9927ms
2025-11-18 13:39:00.077 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:39:00.079 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 52.9822ms
2025-11-18 13:43:14.403 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:43:14.458 +02:00 [WRN] No store type was specified for the decimal property 'BaseFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:43:14.463 +02:00 [WRN] No store type was specified for the decimal property 'FinalFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:43:14.466 +02:00 [WRN] No store type was specified for the decimal property 'TotalDiscount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:43:14.467 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeModifier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:43:14.469 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'PromoCode'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:43:14.470 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'Tier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:43:14.472 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Transaction'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:43:14.474 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:43:14.475 +02:00 [WRN] No store type was specified for the decimal property 'FeeCharged' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:43:15.067 +02:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [BusinessHolidays] AS [b]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:43:15.101 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PaymentMethods] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:43:15.114 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PromoCodes] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:43:15.122 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Tiers] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:43:15.133 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [TransactionTypes] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:43:15.144 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:43:15.153 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Transactions] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:43:15.164 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [FeeModifiers] AS [f]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:43:15.421 +02:00 [INF] Executed DbCommand (40ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p9='?' (DbType = DateTime2), @p10='?' (Size = 4000), @p11='?' (DbType = Int32), @p12='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p13='?' (DbType = DateTime2), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p17='?' (DbType = DateTime2), @p18='?' (Size = 4000), @p19='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [FeeModifiers] USING (
VALUES (@p0, @p1, @p2, @p3, 0),
(@p4, @p5, @p6, @p7, 1),
(@p8, @p9, @p10, @p11, 2),
(@p12, @p13, @p14, @p15, 3),
(@p16, @p17, @p18, @p19, 4)) AS i ([Amount], [CreatedAt], [ModifierName], [Priority], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([Amount], [CreatedAt], [ModifierName], [Priority])
VALUES (i.[Amount], i.[CreatedAt], i.[ModifierName], i.[Priority])
OUTPUT INSERTED.[Id], i._Position;
2025-11-18 13:43:15.705 +02:00 [INF] Now listening on: https://localhost:7261
2025-11-18 13:43:15.706 +02:00 [INF] Now listening on: http://localhost:5186
2025-11-18 13:43:15.762 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-18 13:43:15.763 +02:00 [INF] Hosting environment: Development
2025-11-18 13:43:15.765 +02:00 [INF] Content root path: C:\Users\User\source\repos\FeeCalculationEngine\FeeCalculationEngine.API
2025-11-18 13:43:16.551 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - null null
2025-11-18 13:43:16.797 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - 200 null text/html;charset=utf-8 266.3317ms
2025-11-18 13:43:16.848 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - null null
2025-11-18 13:43:16.848 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - null null
2025-11-18 13:43:16.861 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - 200 16533 application/javascript; charset=utf-8 14.7993ms
2025-11-18 13:43:16.921 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - 200 null text/javascript; charset=UTF-8 75.1176ms
2025-11-18 13:43:16.947 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - null null
2025-11-18 13:43:16.967 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 20.5802ms
2025-11-18 13:47:01.362 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:47:01.420 +02:00 [WRN] No store type was specified for the decimal property 'BaseFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:47:01.423 +02:00 [WRN] No store type was specified for the decimal property 'FinalFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:47:01.425 +02:00 [WRN] No store type was specified for the decimal property 'TotalDiscount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:47:01.427 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeModifier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:47:01.430 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'PromoCode'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:47:01.432 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'Tier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:47:01.434 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Transaction'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:47:01.437 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:47:01.439 +02:00 [WRN] No store type was specified for the decimal property 'FeeCharged' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:47:02.190 +02:00 [INF] Executed DbCommand (36ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [BusinessHolidays] AS [b]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:47:02.230 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PaymentMethods] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:47:02.243 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PromoCodes] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:47:02.256 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Tiers] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:47:02.266 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [TransactionTypes] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:47:02.279 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:47:02.292 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Transactions] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:47:02.312 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [FeeModifiers] AS [f]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:47:02.635 +02:00 [INF] Now listening on: https://localhost:7261
2025-11-18 13:47:02.636 +02:00 [INF] Now listening on: http://localhost:5186
2025-11-18 13:47:02.764 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-18 13:47:02.766 +02:00 [INF] Hosting environment: Development
2025-11-18 13:47:02.767 +02:00 [INF] Content root path: C:\Users\User\source\repos\FeeCalculationEngine\FeeCalculationEngine.API
2025-11-18 13:47:03.797 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - null null
2025-11-18 13:47:04.416 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - 200 null text/html;charset=utf-8 648.3489ms
2025-11-18 13:47:04.530 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - null null
2025-11-18 13:47:04.530 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - null null
2025-11-18 13:47:04.578 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - 200 16533 application/javascript; charset=utf-8 49.4649ms
2025-11-18 13:47:04.685 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - 200 null text/javascript; charset=UTF-8 156.8701ms
2025-11-18 13:47:04.748 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - null null
2025-11-18 13:47:04.797 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 49.9697ms
2025-11-18 13:47:27.032 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 98
2025-11-18 13:47:27.052 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:47:27.107 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:47:27.391 +02:00 [INF] Executed DbCommand (34ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionTypeId] = 3 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:47:27.406 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:47:27.524 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:47:27.630 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:47:27.645 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:47:27.684 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CONVERT(date, [b].[HolidaysDate])
FROM [BusinessHolidays] AS [b]
2025-11-18 13:47:27.705 +02:00 [INF] Final fee: 0, Discount: 0
2025-11-18 13:47:27.942 +02:00 [INF] Executed DbCommand (29ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:47:28.041 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:47:28.050 +02:00 [INF] Transaction persisted for UserId 4: TransactionRequest { UserId = 4, TransactionTypeId = 3, Amount = 800.00, Fee = 0 }
2025-11-18 13:47:28.061 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:47:28.080 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 964.0309ms
2025-11-18 13:47:28.084 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:47:28.091 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 1058.9229ms
2025-11-18 13:47:54.409 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 13:47:54.432 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:47:54.434 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 13:47:54.469 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:47:54.482 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 13:47:54.490 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 13:47:54.499 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 13:47:54.509 +02:00 [INF] Final fee: 10.12, Discount: 4.875000000
2025-11-18 13:47:54.520 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 13:47:54.527 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 13:47:54.530 +02:00 [INF] Transaction persisted for UserId 1: TransactionRequest { UserId = 1, TransactionTypeId = 1, Amount = 1000.00, Fee = 10.12 }
2025-11-18 13:47:54.532 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 13:47:54.535 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 98.3423ms
2025-11-18 13:47:54.536 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 13:47:54.537 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 128.9905ms
2025-11-18 13:48:49.567 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:48:49.644 +02:00 [WRN] No store type was specified for the decimal property 'BaseFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:48:49.646 +02:00 [WRN] No store type was specified for the decimal property 'FinalFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:48:49.647 +02:00 [WRN] No store type was specified for the decimal property 'TotalDiscount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:48:49.649 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'PromoCode'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:48:49.651 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'Tier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:48:49.652 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Transaction'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:48:49.653 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:48:49.655 +02:00 [WRN] No store type was specified for the decimal property 'FeeCharged' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:48:50.407 +02:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [BusinessHolidays] AS [b]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:48:50.443 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PaymentMethods] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:48:50.451 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PromoCodes] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:48:50.460 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Tiers] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:48:50.467 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [TransactionTypes] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:48:50.483 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:48:50.495 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Transactions] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:48:50.509 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [FeeModifiers] AS [f]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:48:50.845 +02:00 [INF] Now listening on: https://localhost:7261
2025-11-18 13:48:50.847 +02:00 [INF] Now listening on: http://localhost:5186
2025-11-18 13:48:50.971 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-18 13:48:50.974 +02:00 [INF] Hosting environment: Development
2025-11-18 13:48:50.975 +02:00 [INF] Content root path: C:\Users\User\source\repos\FeeCalculationEngine\FeeCalculationEngine.API
2025-11-18 13:48:52.241 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - null null
2025-11-18 13:48:52.738 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - 200 null text/html;charset=utf-8 535.6261ms
2025-11-18 13:48:52.824 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - null null
2025-11-18 13:48:52.824 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - null null
2025-11-18 13:48:52.849 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - 200 16533 application/javascript; charset=utf-8 26.6155ms
2025-11-18 13:48:52.950 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - 200 null text/javascript; charset=UTF-8 127.9775ms
2025-11-18 13:48:53.000 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - null null
2025-11-18 13:48:53.045 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 47.1557ms
2025-11-18 13:49:44.172 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:49:44.224 +02:00 [WRN] No store type was specified for the decimal property 'BaseFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:49:44.224 +02:00 [WRN] No store type was specified for the decimal property 'FinalFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:49:44.224 +02:00 [WRN] No store type was specified for the decimal property 'TotalDiscount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:49:44.224 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'PromoCode'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:49:44.224 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'Tier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:49:44.224 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Transaction'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:49:44.224 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:49:44.224 +02:00 [WRN] No store type was specified for the decimal property 'FeeCharged' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:49:44.326 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:49:44.326 +02:00 [WRN] No store type was specified for the decimal property 'BaseFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:49:44.326 +02:00 [WRN] No store type was specified for the decimal property 'FinalFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:49:44.326 +02:00 [WRN] No store type was specified for the decimal property 'TotalDiscount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:49:44.326 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'PromoCode'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:49:44.326 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'Tier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:49:44.327 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Transaction'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:49:44.327 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:49:44.327 +02:00 [WRN] No store type was specified for the decimal property 'FeeCharged' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:49:50.031 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:49:50.053 +02:00 [WRN] No store type was specified for the decimal property 'BaseFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:49:50.053 +02:00 [WRN] No store type was specified for the decimal property 'FinalFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:49:50.053 +02:00 [WRN] No store type was specified for the decimal property 'TotalDiscount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:49:50.053 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'PromoCode'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:49:50.053 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'Tier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:49:50.053 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Transaction'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:49:50.053 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:49:50.053 +02:00 [WRN] No store type was specified for the decimal property 'FeeCharged' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:49:50.456 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-18 13:49:50.474 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-18 13:49:50.476 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-18 13:49:50.531 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2025-11-18 13:49:50.532 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-18 13:49:50.533 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-18 13:49:50.543 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-18 13:49:50.554 +02:00 [INF] Applying migration '20251118114944_InitialMigration'.
2025-11-18 13:49:50.601 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [BusinessHolidays] (
    [Id] int NOT NULL IDENTITY,
    [HolidaysDate] datetime2 NOT NULL,
    [Description] nvarchar(max) NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_BusinessHolidays] PRIMARY KEY ([Id])
);
2025-11-18 13:49:50.604 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [FeeModifiers] (
    [Id] int NOT NULL IDENTITY,
    [ModifierName] nvarchar(max) NOT NULL,
    [Priority] int NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_FeeModifiers] PRIMARY KEY ([Id])
);
2025-11-18 13:49:50.606 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [PaymentMethods] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(max) NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_PaymentMethods] PRIMARY KEY ([Id])
);
2025-11-18 13:49:50.609 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [PromoCodes] (
    [Id] int NOT NULL IDENTITY,
    [Code] nvarchar(max) NOT NULL,
    [DiscountPercentage] decimal(18,2) NOT NULL,
    [ExpiryDate] datetime2 NOT NULL,
    [IsActive] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_PromoCodes] PRIMARY KEY ([Id])
);
2025-11-18 13:49:50.613 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Tiers] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(max) NOT NULL,
    [DiscountPercentage] decimal(18,2) NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_Tiers] PRIMARY KEY ([Id])
);
2025-11-18 13:49:50.615 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [TransactionTypes] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(max) NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_TransactionTypes] PRIMARY KEY ([Id])
);
2025-11-18 13:49:50.619 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Users] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(max) NULL,
    [Email] nvarchar(max) NULL,
    [TierId] int NOT NULL,
    [IsHighVolume] bit NOT NULL,
    [IsFirstTime] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_Users] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Users_Tiers_TierId] FOREIGN KEY ([TierId]) REFERENCES [Tiers] ([Id]) ON DELETE CASCADE
);
2025-11-18 13:49:50.622 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [FeeAuditLogs] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [TransactionTypeId] int NOT NULL,
    [Amount] decimal(18,2) NOT NULL,
    [BaseFee] decimal(18,2) NOT NULL,
    [TotalDiscount] decimal(18,2) NOT NULL,
    [FinalFee] decimal(18,2) NOT NULL,
    [Breakdown] nvarchar(max) NOT NULL,
    [StackingStrategy] nvarchar(max) NOT NULL,
    [TransactionDate] datetime2 NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_FeeAuditLogs] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_FeeAuditLogs_TransactionTypes_TransactionTypeId] FOREIGN KEY ([TransactionTypeId]) REFERENCES [TransactionTypes] ([Id]) ON DELETE CASCADE
);
2025-11-18 13:49:50.626 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserTransactionHistories] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [TransactionTypeId] int NOT NULL,
    [TransactionDate] datetime2 NOT NULL,
    [Amount] decimal(18,2) NOT NULL,
    [FeeCharged] decimal(18,2) NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_UserTransactionHistories] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_UserTransactionHistories_TransactionTypes_TransactionTypeId] FOREIGN KEY ([TransactionTypeId]) REFERENCES [TransactionTypes] ([Id]) ON DELETE CASCADE
);
2025-11-18 13:49:50.633 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Transactions] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [Amount] decimal(18,2) NOT NULL,
    [TransactionTypeId] int NOT NULL,
    [PaymentMethodId] int NOT NULL,
    [PromoCodeId] int NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_Transactions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Transactions_PaymentMethods_PaymentMethodId] FOREIGN KEY ([PaymentMethodId]) REFERENCES [PaymentMethods] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Transactions_PromoCodes_PromoCodeId] FOREIGN KEY ([PromoCodeId]) REFERENCES [PromoCodes] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Transactions_TransactionTypes_TransactionTypeId] FOREIGN KEY ([TransactionTypeId]) REFERENCES [TransactionTypes] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Transactions_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-11-18 13:49:50.635 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_FeeAuditLogs_TransactionTypeId] ON [FeeAuditLogs] ([TransactionTypeId]);
2025-11-18 13:49:50.637 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Transactions_PaymentMethodId] ON [Transactions] ([PaymentMethodId]);
2025-11-18 13:49:50.638 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Transactions_PromoCodeId] ON [Transactions] ([PromoCodeId]);
2025-11-18 13:49:50.640 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Transactions_TransactionTypeId] ON [Transactions] ([TransactionTypeId]);
2025-11-18 13:49:50.641 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Transactions_UserId] ON [Transactions] ([UserId]);
2025-11-18 13:49:50.642 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Users_TierId] ON [Users] ([TierId]);
2025-11-18 13:49:50.644 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserTransactionHistories_TransactionTypeId] ON [UserTransactionHistories] ([TransactionTypeId]);
2025-11-18 13:49:52.466 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251118114944_InitialMigration', N'8.0.0');
2025-11-18 13:50:09.205 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:50:09.259 +02:00 [WRN] No store type was specified for the decimal property 'BaseFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:50:09.265 +02:00 [WRN] No store type was specified for the decimal property 'FinalFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:50:09.268 +02:00 [WRN] No store type was specified for the decimal property 'TotalDiscount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:50:09.271 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'PromoCode'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:50:09.273 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'Tier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:50:09.275 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Transaction'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:50:09.278 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:50:09.280 +02:00 [WRN] No store type was specified for the decimal property 'FeeCharged' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 13:50:09.943 +02:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [BusinessHolidays] AS [b]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:50:10.373 +02:00 [INF] Executed DbCommand (59ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (DbType = DateTime2), @p10='?' (Size = 4000), @p11='?' (DbType = DateTime2), @p12='?' (DbType = DateTime2), @p13='?' (Size = 4000), @p14='?' (DbType = DateTime2), @p15='?' (DbType = DateTime2), @p16='?' (Size = 4000), @p17='?' (DbType = DateTime2), @p18='?' (DbType = DateTime2), @p19='?' (Size = 4000), @p20='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [BusinessHolidays] USING (
VALUES (@p0, @p1, @p2, 0),
(@p3, @p4, @p5, 1),
(@p6, @p7, @p8, 2),
(@p9, @p10, @p11, 3),
(@p12, @p13, @p14, 4),
(@p15, @p16, @p17, 5),
(@p18, @p19, @p20, 6)) AS i ([CreatedAt], [Description], [HolidaysDate], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CreatedAt], [Description], [HolidaysDate])
VALUES (i.[CreatedAt], i.[Description], i.[HolidaysDate])
OUTPUT INSERTED.[Id], i._Position;
2025-11-18 13:50:10.425 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PaymentMethods] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:50:10.476 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [PaymentMethods] USING (
VALUES (@p0, @p1, 0),
(@p2, @p3, 1),
(@p4, @p5, 2)) AS i ([CreatedAt], [Name], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CreatedAt], [Name])
VALUES (i.[CreatedAt], i.[Name])
OUTPUT INSERTED.[Id], i._Position;
2025-11-18 13:50:10.490 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PromoCodes] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:50:10.570 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Boolean), @p10='?' (Size = 4000), @p11='?' (DbType = DateTime2), @p12='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p13='?' (DbType = DateTime2), @p14='?' (DbType = Boolean), @p15='?' (Size = 4000), @p16='?' (DbType = DateTime2), @p17='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p18='?' (DbType = DateTime2), @p19='?' (DbType = Boolean), @p20='?' (Size = 4000), @p21='?' (DbType = DateTime2), @p22='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p23='?' (DbType = DateTime2), @p24='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [PromoCodes] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, 0),
(@p5, @p6, @p7, @p8, @p9, 1),
(@p10, @p11, @p12, @p13, @p14, 2),
(@p15, @p16, @p17, @p18, @p19, 3),
(@p20, @p21, @p22, @p23, @p24, 4)) AS i ([Code], [CreatedAt], [DiscountPercentage], [ExpiryDate], [IsActive], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([Code], [CreatedAt], [DiscountPercentage], [ExpiryDate], [IsActive])
VALUES (i.[Code], i.[CreatedAt], i.[DiscountPercentage], i.[ExpiryDate], i.[IsActive])
OUTPUT INSERTED.[Id], i._Position;
2025-11-18 13:50:10.586 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Tiers] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:50:10.645 +02:00 [INF] Executed DbCommand (14ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [Tiers] USING (
VALUES (@p0, @p1, @p2, 0),
(@p3, @p4, @p5, 1)) AS i ([CreatedAt], [DiscountPercentage], [Name], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CreatedAt], [DiscountPercentage], [Name])
VALUES (i.[CreatedAt], i.[DiscountPercentage], i.[Name])
OUTPUT INSERTED.[Id], i._Position;
2025-11-18 13:50:10.658 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [TransactionTypes] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:50:10.709 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [TransactionTypes] USING (
VALUES (@p0, @p1, 0),
(@p2, @p3, 1),
(@p4, @p5, 2),
(@p6, @p7, 3)) AS i ([CreatedAt], [Name], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CreatedAt], [Name])
VALUES (i.[CreatedAt], i.[Name])
OUTPUT INSERTED.[Id], i._Position;
2025-11-18 13:50:10.723 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:50:10.819 +02:00 [INF] Executed DbCommand (19ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (DbType = Boolean), @p3='?' (DbType = Boolean), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = Boolean), @p9='?' (DbType = Boolean), @p10='?' (Size = 4000), @p11='?' (DbType = Int32), @p12='?' (DbType = DateTime2), @p13='?' (Size = 4000), @p14='?' (DbType = Boolean), @p15='?' (DbType = Boolean), @p16='?' (Size = 4000), @p17='?' (DbType = Int32), @p18='?' (DbType = DateTime2), @p19='?' (Size = 4000), @p20='?' (DbType = Boolean), @p21='?' (DbType = Boolean), @p22='?' (Size = 4000), @p23='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [Users] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, 0),
(@p6, @p7, @p8, @p9, @p10, @p11, 1),
(@p12, @p13, @p14, @p15, @p16, @p17, 2),
(@p18, @p19, @p20, @p21, @p22, @p23, 3)) AS i ([CreatedAt], [Email], [IsFirstTime], [IsHighVolume], [Name], [TierId], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CreatedAt], [Email], [IsFirstTime], [IsHighVolume], [Name], [TierId])
VALUES (i.[CreatedAt], i.[Email], i.[IsFirstTime], i.[IsHighVolume], i.[Name], i.[TierId])
OUTPUT INSERTED.[Id], i._Position;
2025-11-18 13:50:10.835 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Transactions] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:50:10.928 +02:00 [INF] Executed DbCommand (44ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p13='?' (DbType = DateTime2), @p14='?' (DbType = Int32), @p15='?' (DbType = Int32), @p16='?' (DbType = Int32), @p17='?' (DbType = Int32), @p18='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p19='?' (DbType = DateTime2), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (DbType = Int32), @p23='?' (DbType = Int32), @p24='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p25='?' (DbType = DateTime2), @p26='?' (DbType = Int32), @p27='?' (DbType = Int32), @p28='?' (DbType = Int32), @p29='?' (DbType = Int32), @p30='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p31='?' (DbType = DateTime2), @p32='?' (DbType = Int32), @p33='?' (DbType = Int32), @p34='?' (DbType = Int32), @p35='?' (DbType = Int32), @p36='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p37='?' (DbType = DateTime2), @p38='?' (DbType = Int32), @p39='?' (DbType = Int32), @p40='?' (DbType = Int32), @p41='?' (DbType = Int32), @p42='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p43='?' (DbType = DateTime2), @p44='?' (DbType = Int32), @p45='?' (DbType = Int32), @p46='?' (DbType = Int32), @p47='?' (DbType = Int32), @p48='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p49='?' (DbType = DateTime2), @p50='?' (DbType = Int32), @p51='?' (DbType = Int32), @p52='?' (DbType = Int32), @p53='?' (DbType = Int32), @p54='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p55='?' (DbType = DateTime2), @p56='?' (DbType = Int32), @p57='?' (DbType = Int32), @p58='?' (DbType = Int32), @p59='?' (DbType = Int32), @p60='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p61='?' (DbType = DateTime2), @p62='?' (DbType = Int32), @p63='?' (DbType = Int32), @p64='?' (DbType = Int32), @p65='?' (DbType = Int32), @p66='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p67='?' (DbType = DateTime2), @p68='?' (DbType = Int32), @p69='?' (DbType = Int32), @p70='?' (DbType = Int32), @p71='?' (DbType = Int32), @p72='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p73='?' (DbType = DateTime2), @p74='?' (DbType = Int32), @p75='?' (DbType = Int32), @p76='?' (DbType = Int32), @p77='?' (DbType = Int32), @p78='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p79='?' (DbType = DateTime2), @p80='?' (DbType = Int32), @p81='?' (DbType = Int32), @p82='?' (DbType = Int32), @p83='?' (DbType = Int32), @p84='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p85='?' (DbType = DateTime2), @p86='?' (DbType = Int32), @p87='?' (DbType = Int32), @p88='?' (DbType = Int32), @p89='?' (DbType = Int32), @p90='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p91='?' (DbType = DateTime2), @p92='?' (DbType = Int32), @p93='?' (DbType = Int32), @p94='?' (DbType = Int32), @p95='?' (DbType = Int32), @p96='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p97='?' (DbType = DateTime2), @p98='?' (DbType = Int32), @p99='?' (DbType = Int32), @p100='?' (DbType = Int32), @p101='?' (DbType = Int32), @p102='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p103='?' (DbType = DateTime2), @p104='?' (DbType = Int32), @p105='?' (DbType = Int32), @p106='?' (DbType = Int32), @p107='?' (DbType = Int32), @p108='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p109='?' (DbType = DateTime2), @p110='?' (DbType = Int32), @p111='?' (DbType = Int32), @p112='?' (DbType = Int32), @p113='?' (DbType = Int32), @p114='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p115='?' (DbType = DateTime2), @p116='?' (DbType = Int32), @p117='?' (DbType = Int32), @p118='?' (DbType = Int32), @p119='?' (DbType = Int32), @p120='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p121='?' (DbType = DateTime2), @p122='?' (DbType = Int32), @p123='?' (DbType = Int32), @p124='?' (DbType = Int32), @p125='?' (DbType = Int32), @p126='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p127='?' (DbType = DateTime2), @p128='?' (DbType = Int32), @p129='?' (DbType = Int32), @p130='?' (DbType = Int32), @p131='?' (DbType = Int32), @p132='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p133='?' (DbType = DateTime2), @p134='?' (DbType = Int32), @p135='?' (DbType = Int32), @p136='?' (DbType = Int32), @p137='?' (DbType = Int32), @p138='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p139='?' (DbType = DateTime2), @p140='?' (DbType = Int32), @p141='?' (DbType = Int32), @p142='?' (DbType = Int32), @p143='?' (DbType = Int32), @p144='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p145='?' (DbType = DateTime2), @p146='?' (DbType = Int32), @p147='?' (DbType = Int32), @p148='?' (DbType = Int32), @p149='?' (DbType = Int32), @p150='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p151='?' (DbType = DateTime2), @p152='?' (DbType = Int32), @p153='?' (DbType = Int32), @p154='?' (DbType = Int32), @p155='?' (DbType = Int32), @p156='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p157='?' (DbType = DateTime2), @p158='?' (DbType = Int32), @p159='?' (DbType = Int32), @p160='?' (DbType = Int32), @p161='?' (DbType = Int32), @p162='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p163='?' (DbType = DateTime2), @p164='?' (DbType = Int32), @p165='?' (DbType = Int32), @p166='?' (DbType = Int32), @p167='?' (DbType = Int32), @p168='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p169='?' (DbType = DateTime2), @p170='?' (DbType = Int32), @p171='?' (DbType = Int32), @p172='?' (DbType = Int32), @p173='?' (DbType = Int32), @p174='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p175='?' (DbType = DateTime2), @p176='?' (DbType = Int32), @p177='?' (DbType = Int32), @p178='?' (DbType = Int32), @p179='?' (DbType = Int32), @p180='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p181='?' (DbType = DateTime2), @p182='?' (DbType = Int32), @p183='?' (DbType = Int32), @p184='?' (DbType = Int32), @p185='?' (DbType = Int32), @p186='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p187='?' (DbType = DateTime2), @p188='?' (DbType = Int32), @p189='?' (DbType = Int32), @p190='?' (DbType = Int32), @p191='?' (DbType = Int32), @p192='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p193='?' (DbType = DateTime2), @p194='?' (DbType = Int32), @p195='?' (DbType = Int32), @p196='?' (DbType = Int32), @p197='?' (DbType = Int32), @p198='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p199='?' (DbType = DateTime2), @p200='?' (DbType = Int32), @p201='?' (DbType = Int32), @p202='?' (DbType = Int32), @p203='?' (DbType = Int32), @p204='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p205='?' (DbType = DateTime2), @p206='?' (DbType = Int32), @p207='?' (DbType = Int32), @p208='?' (DbType = Int32), @p209='?' (DbType = Int32), @p210='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p211='?' (DbType = DateTime2), @p212='?' (DbType = Int32), @p213='?' (DbType = Int32), @p214='?' (DbType = Int32), @p215='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [Transactions] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, 0),
(@p6, @p7, @p8, @p9, @p10, @p11, 1),
(@p12, @p13, @p14, @p15, @p16, @p17, 2),
(@p18, @p19, @p20, @p21, @p22, @p23, 3),
(@p24, @p25, @p26, @p27, @p28, @p29, 4),
(@p30, @p31, @p32, @p33, @p34, @p35, 5),
(@p36, @p37, @p38, @p39, @p40, @p41, 6),
(@p42, @p43, @p44, @p45, @p46, @p47, 7),
(@p48, @p49, @p50, @p51, @p52, @p53, 8),
(@p54, @p55, @p56, @p57, @p58, @p59, 9),
(@p60, @p61, @p62, @p63, @p64, @p65, 10),
(@p66, @p67, @p68, @p69, @p70, @p71, 11),
(@p72, @p73, @p74, @p75, @p76, @p77, 12),
(@p78, @p79, @p80, @p81, @p82, @p83, 13),
(@p84, @p85, @p86, @p87, @p88, @p89, 14),
(@p90, @p91, @p92, @p93, @p94, @p95, 15),
(@p96, @p97, @p98, @p99, @p100, @p101, 16),
(@p102, @p103, @p104, @p105, @p106, @p107, 17),
(@p108, @p109, @p110, @p111, @p112, @p113, 18),
(@p114, @p115, @p116, @p117, @p118, @p119, 19),
(@p120, @p121, @p122, @p123, @p124, @p125, 20),
(@p126, @p127, @p128, @p129, @p130, @p131, 21),
(@p132, @p133, @p134, @p135, @p136, @p137, 22),
(@p138, @p139, @p140, @p141, @p142, @p143, 23),
(@p144, @p145, @p146, @p147, @p148, @p149, 24),
(@p150, @p151, @p152, @p153, @p154, @p155, 25),
(@p156, @p157, @p158, @p159, @p160, @p161, 26),
(@p162, @p163, @p164, @p165, @p166, @p167, 27),
(@p168, @p169, @p170, @p171, @p172, @p173, 28),
(@p174, @p175, @p176, @p177, @p178, @p179, 29),
(@p180, @p181, @p182, @p183, @p184, @p185, 30),
(@p186, @p187, @p188, @p189, @p190, @p191, 31),
(@p192, @p193, @p194, @p195, @p196, @p197, 32),
(@p198, @p199, @p200, @p201, @p202, @p203, 33),
(@p204, @p205, @p206, @p207, @p208, @p209, 34),
(@p210, @p211, @p212, @p213, @p214, @p215, 35)) AS i ([Amount], [CreatedAt], [PaymentMethodId], [PromoCodeId], [TransactionTypeId], [UserId], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([Amount], [CreatedAt], [PaymentMethodId], [PromoCodeId], [TransactionTypeId], [UserId])
VALUES (i.[Amount], i.[CreatedAt], i.[PaymentMethodId], i.[PromoCodeId], i.[TransactionTypeId], i.[UserId])
OUTPUT INSERTED.[Id], i._Position;
2025-11-18 13:50:10.946 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [FeeModifiers] AS [f]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 13:50:10.978 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = Int32), @p9='?' (DbType = DateTime2), @p10='?' (Size = 4000), @p11='?' (DbType = Int32), @p12='?' (DbType = DateTime2), @p13='?' (Size = 4000), @p14='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [FeeModifiers] USING (
VALUES (@p0, @p1, @p2, 0),
(@p3, @p4, @p5, 1),
(@p6, @p7, @p8, 2),
(@p9, @p10, @p11, 3),
(@p12, @p13, @p14, 4)) AS i ([CreatedAt], [ModifierName], [Priority], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CreatedAt], [ModifierName], [Priority])
VALUES (i.[CreatedAt], i.[ModifierName], i.[Priority])
OUTPUT INSERTED.[Id], i._Position;
2025-11-18 13:50:11.304 +02:00 [INF] Now listening on: https://localhost:7261
2025-11-18 13:50:11.307 +02:00 [INF] Now listening on: http://localhost:5186
2025-11-18 13:50:11.386 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-18 13:50:11.388 +02:00 [INF] Hosting environment: Development
2025-11-18 13:50:11.389 +02:00 [INF] Content root path: C:\Users\User\source\repos\FeeCalculationEngine\FeeCalculationEngine.API
2025-11-18 13:50:12.452 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - null null
2025-11-18 13:50:12.937 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - 200 null text/html;charset=utf-8 510.8273ms
2025-11-18 13:50:13.012 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - null null
2025-11-18 13:50:13.012 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - null null
2025-11-18 13:50:13.035 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - 200 16533 application/javascript; charset=utf-8 24.0061ms
2025-11-18 13:50:13.319 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - 200 null text/javascript; charset=UTF-8 307.7268ms
2025-11-18 13:50:13.368 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - null null
2025-11-18 13:50:13.405 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 38.6425ms
2025-11-18 14:32:53.509 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 14:32:53.556 +02:00 [WRN] No store type was specified for the decimal property 'BaseFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 14:32:53.558 +02:00 [WRN] No store type was specified for the decimal property 'FinalFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 14:32:53.558 +02:00 [WRN] No store type was specified for the decimal property 'TotalDiscount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 14:32:53.559 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'PromoCode'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 14:32:53.560 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'Tier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 14:32:53.560 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Transaction'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 14:32:53.561 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 14:32:53.561 +02:00 [WRN] No store type was specified for the decimal property 'FeeCharged' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 14:32:54.268 +02:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [BusinessHolidays] AS [b]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:32:54.307 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PaymentMethods] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:32:54.315 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PromoCodes] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:32:54.327 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Tiers] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:32:54.336 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [TransactionTypes] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:32:54.345 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:32:54.353 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Transactions] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:32:54.362 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [FeeModifiers] AS [f]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:32:54.679 +02:00 [INF] Now listening on: https://localhost:7261
2025-11-18 14:32:54.680 +02:00 [INF] Now listening on: http://localhost:5186
2025-11-18 14:32:54.815 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-18 14:32:54.822 +02:00 [INF] Hosting environment: Development
2025-11-18 14:32:54.825 +02:00 [INF] Content root path: C:\Users\User\source\repos\FeeCalculationEngine\FeeCalculationEngine.API
2025-11-18 14:32:55.499 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - null null
2025-11-18 14:32:55.845 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - 200 null text/html;charset=utf-8 365.7944ms
2025-11-18 14:32:55.857 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - null null
2025-11-18 14:32:55.869 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - null null
2025-11-18 14:32:55.869 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - 200 16533 application/javascript; charset=utf-8 12.351ms
2025-11-18 14:32:55.932 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - 200 null text/javascript; charset=UTF-8 63.7425ms
2025-11-18 14:32:55.963 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - null null
2025-11-18 14:32:55.985 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 22.9396ms
2025-11-18 14:33:16.528 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:33:16.553 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:33:16.595 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:33:16.800 +02:00 [INF] Executed DbCommand (32ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:33:16.940 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:33:17.077 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:33:17.092 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:33:17.132 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CONVERT(date, [b].[HolidaysDate])
FROM [BusinessHolidays] AS [b]
2025-11-18 14:33:17.149 +02:00 [INF] Final fee: 0, Discount: 15.00000
2025-11-18 14:33:17.384 +02:00 [INF] Executed DbCommand (42ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:33:17.460 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:33:17.470 +02:00 [INF] Transaction persisted for UserId 1: TransactionRequest { UserId = 1, TransactionTypeId = 1, Amount = 1000.00, Fee = 0 }
2025-11-18 14:33:17.478 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:33:17.495 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 893.7496ms
2025-11-18 14:33:17.497 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:33:17.501 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 972.722ms
2025-11-18 14:33:31.521 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:33:31.533 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:33:31.536 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:33:31.585 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:33:31.590 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:33:31.595 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:33:31.599 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:33:31.607 +02:00 [INF] Final fee: 13.07, Discount: 7.431250000
2025-11-18 14:33:31.616 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:33:31.622 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:33:31.625 +02:00 [INF] Transaction persisted for UserId 1: TransactionRequest { UserId = 1, TransactionTypeId = 1, Amount = 1100.00, Fee = 13.07 }
2025-11-18 14:33:31.626 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:33:31.628 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 89.353ms
2025-11-18 14:33:31.630 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:33:31.632 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 110.5727ms
2025-11-18 14:33:37.886 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:33:37.895 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:33:37.896 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:33:37.909 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:33:37.914 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:33:37.919 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:33:37.923 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:33:37.927 +02:00 [INF] Final fee: 11.81, Discount: 9.187500000
2025-11-18 14:33:37.935 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:33:37.942 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:33:37.946 +02:00 [INF] Transaction persisted for UserId 1: TransactionRequest { UserId = 1, TransactionTypeId = 1, Amount = 1200.00, Fee = 11.81 }
2025-11-18 14:33:37.948 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:33:37.950 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 50.8249ms
2025-11-18 14:33:37.951 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:33:37.953 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 67.799ms
2025-11-18 14:33:42.210 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:33:42.216 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:33:42.219 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:33:42.226 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:33:42.245 +02:00 [INF] Executed DbCommand (14ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:33:42.261 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:33:42.268 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:33:42.273 +02:00 [INF] Final fee: 14.51, Discount: 6.987500000
2025-11-18 14:33:42.282 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:33:42.291 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:33:42.295 +02:00 [INF] Transaction persisted for UserId 1: TransactionRequest { UserId = 1, TransactionTypeId = 1, Amount = 1300.00, Fee = 14.51 }
2025-11-18 14:33:42.298 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:33:42.300 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 76.698ms
2025-11-18 14:33:42.302 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:33:42.305 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 94.3661ms
2025-11-18 14:33:45.909 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:33:45.914 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:33:45.916 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:33:45.927 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:33:45.940 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:33:45.949 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:33:45.957 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:33:45.961 +02:00 [INF] Final fee: 14.02, Discount: 7.975000000
2025-11-18 14:33:45.970 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:33:45.981 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:33:45.986 +02:00 [INF] Transaction persisted for UserId 1: TransactionRequest { UserId = 1, TransactionTypeId = 1, Amount = 1400.00, Fee = 14.02 }
2025-11-18 14:33:45.988 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:33:45.991 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 71.6091ms
2025-11-18 14:33:45.993 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:33:45.996 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 87.6924ms
2025-11-18 14:33:50.641 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:33:50.647 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:33:50.649 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:33:50.656 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:33:50.667 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:33:50.674 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:33:50.680 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:33:50.683 +02:00 [INF] Final fee: 12.66, Discount: 9.843750000
2025-11-18 14:33:50.694 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:33:50.701 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:33:50.704 +02:00 [INF] Transaction persisted for UserId 1: TransactionRequest { UserId = 1, TransactionTypeId = 1, Amount = 1500.00, Fee = 12.66 }
2025-11-18 14:33:50.706 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:33:50.708 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 55.6989ms
2025-11-18 14:33:50.710 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:33:50.712 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 71.5697ms
2025-11-18 14:33:54.762 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:33:54.771 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:33:54.773 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:33:54.778 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:33:54.783 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:33:54.788 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:33:54.792 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:33:54.795 +02:00 [INF] Final fee: 15.52, Discount: 7.475000000
2025-11-18 14:33:54.800 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:33:54.806 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:33:54.809 +02:00 [INF] Transaction persisted for UserId 1: TransactionRequest { UserId = 1, TransactionTypeId = 1, Amount = 1600.00, Fee = 15.52 }
2025-11-18 14:33:54.811 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:33:54.813 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 38.1652ms
2025-11-18 14:33:54.815 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:33:54.817 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 57.143ms
2025-11-18 14:33:58.585 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:33:58.595 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:33:58.596 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:33:58.601 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:33:58.605 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:33:58.608 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:33:58.611 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:33:58.614 +02:00 [INF] Final fee: 14.98, Discount: 8.518750000
2025-11-18 14:33:58.623 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:33:58.629 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:33:58.632 +02:00 [INF] Transaction persisted for UserId 1: TransactionRequest { UserId = 1, TransactionTypeId = 1, Amount = 1700.00, Fee = 14.98 }
2025-11-18 14:33:58.634 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:33:58.637 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 39.0835ms
2025-11-18 14:33:58.639 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:33:58.640 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 55.1316ms
2025-11-18 14:34:02.399 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:34:02.410 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:34:02.411 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:34:02.416 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:34:02.424 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:34:02.427 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:34:02.430 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:34:02.433 +02:00 [INF] Final fee: 13.50, Discount: 10.500000000
2025-11-18 14:34:02.445 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:34:02.452 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:34:02.456 +02:00 [INF] Transaction persisted for UserId 1: TransactionRequest { UserId = 1, TransactionTypeId = 1, Amount = 1800.00, Fee = 13.50 }
2025-11-18 14:34:02.458 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:34:02.460 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 47.0754ms
2025-11-18 14:34:02.462 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:34:02.465 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 68.6326ms
2025-11-18 14:34:40.078 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:34:40.086 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:34:40.087 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:34:40.092 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:34:40.096 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:34:40.102 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:34:40.106 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:34:40.109 +02:00 [INF] Final fee: 0, Discount: 65.0000
2025-11-18 14:34:40.115 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:34:40.123 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:34:40.125 +02:00 [INF] Transaction persisted for UserId 2: TransactionRequest { UserId = 2, TransactionTypeId = 2, Amount = 2000.00, Fee = 0 }
2025-11-18 14:34:40.127 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:34:40.129 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 39.1798ms
2025-11-18 14:34:40.130 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:34:40.132 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 53.8745ms
2025-11-18 14:34:43.746 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:34:43.753 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:34:43.754 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:34:43.758 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:34:43.762 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:34:43.769 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:34:43.774 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:34:43.776 +02:00 [INF] Final fee: 43.35, Discount: 24.65000000
2025-11-18 14:34:43.782 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:34:43.788 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:34:43.791 +02:00 [INF] Transaction persisted for UserId 2: TransactionRequest { UserId = 2, TransactionTypeId = 2, Amount = 2100.00, Fee = 43.35 }
2025-11-18 14:34:43.793 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:34:43.795 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 39.0867ms
2025-11-18 14:34:43.797 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:34:43.798 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 53.6865ms
2025-11-18 14:34:47.201 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:34:47.210 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:34:47.213 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:34:47.220 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:34:47.225 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:34:47.230 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:34:47.236 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:34:47.240 +02:00 [INF] Final fee: 39.94, Discount: 31.06250000
2025-11-18 14:34:47.245 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:34:47.252 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:34:47.255 +02:00 [INF] Transaction persisted for UserId 2: TransactionRequest { UserId = 2, TransactionTypeId = 2, Amount = 2200.00, Fee = 39.94 }
2025-11-18 14:34:47.257 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:34:47.260 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 43.2673ms
2025-11-18 14:34:47.261 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:34:47.263 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 62.338ms
2025-11-18 14:34:50.529 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:34:50.537 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:34:50.538 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:34:50.548 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:34:50.562 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:34:50.573 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:34:50.580 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:34:50.585 +02:00 [INF] Final fee: 49.95, Discount: 24.05000000
2025-11-18 14:34:50.595 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:34:50.605 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:34:50.610 +02:00 [INF] Transaction persisted for UserId 2: TransactionRequest { UserId = 2, TransactionTypeId = 2, Amount = 2300.00, Fee = 49.95 }
2025-11-18 14:34:50.612 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:34:50.615 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 73.2807ms
2025-11-18 14:34:50.618 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:34:50.621 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 93.0485ms
2025-11-18 14:34:53.437 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:34:53.452 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:34:53.455 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:34:53.464 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:34:53.483 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:34:53.489 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:34:53.495 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:34:53.498 +02:00 [INF] Final fee: 49.09, Discount: 27.91250000
2025-11-18 14:34:53.506 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:34:53.513 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:34:53.517 +02:00 [INF] Transaction persisted for UserId 2: TransactionRequest { UserId = 2, TransactionTypeId = 2, Amount = 2400.00, Fee = 49.09 }
2025-11-18 14:34:53.519 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:34:53.521 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 63.4333ms
2025-11-18 14:34:53.523 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:34:53.524 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 88.1009ms
2025-11-18 14:34:56.278 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:34:56.287 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:34:56.290 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:34:56.295 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:34:56.298 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:34:56.304 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:34:56.308 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:34:56.311 +02:00 [INF] Final fee: 45.00, Discount: 35.00000000
2025-11-18 14:34:56.320 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:34:56.325 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:34:56.328 +02:00 [INF] Transaction persisted for UserId 2: TransactionRequest { UserId = 2, TransactionTypeId = 2, Amount = 2500.00, Fee = 45.00 }
2025-11-18 14:34:56.330 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:34:56.332 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 40.0261ms
2025-11-18 14:34:56.335 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:34:56.336 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 58.4622ms
2025-11-18 14:34:59.287 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:34:59.302 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:34:59.304 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:34:59.309 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:34:59.313 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:34:59.320 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:34:59.324 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:34:59.327 +02:00 [INF] Final fee: 56.02, Discount: 26.97500000
2025-11-18 14:34:59.343 +02:00 [INF] Executed DbCommand (14ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:34:59.348 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:34:59.352 +02:00 [INF] Transaction persisted for UserId 2: TransactionRequest { UserId = 2, TransactionTypeId = 2, Amount = 2600.00, Fee = 56.02 }
2025-11-18 14:34:59.354 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:34:59.356 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 49.1453ms
2025-11-18 14:34:59.358 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:34:59.359 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 72.3658ms
2025-11-18 14:35:03.681 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:35:03.691 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:03.696 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:35:03.702 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:35:03.706 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:35:03.710 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:35:03.713 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:35:03.720 +02:00 [INF] Final fee: 54.82, Discount: 31.17500000
2025-11-18 14:35:03.728 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:35:03.733 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:35:03.736 +02:00 [INF] Transaction persisted for UserId 2: TransactionRequest { UserId = 2, TransactionTypeId = 2, Amount = 2700.00, Fee = 54.82 }
2025-11-18 14:35:03.738 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:35:03.740 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 41.4189ms
2025-11-18 14:35:03.742 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:03.743 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 63.1991ms
2025-11-18 14:35:06.955 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:35:06.958 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:06.959 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:35:06.962 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:35:06.967 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:35:06.970 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:35:06.973 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:35:06.975 +02:00 [INF] Final fee: 50.06, Discount: 38.93750000
2025-11-18 14:35:06.984 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:35:06.987 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:35:06.989 +02:00 [INF] Transaction persisted for UserId 2: TransactionRequest { UserId = 2, TransactionTypeId = 2, Amount = 2800.00, Fee = 50.06 }
2025-11-18 14:35:06.991 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:35:06.992 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 31.8273ms
2025-11-18 14:35:06.994 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:06.996 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 41.9571ms
2025-11-18 14:35:10.142 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:35:10.152 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:10.155 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:35:10.177 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionTypeId] = 3 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:35:10.183 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:35:10.187 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:35:10.191 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:35:10.195 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:35:10.200 +02:00 [INF] Final fee: 0, Discount: 0
2025-11-18 14:35:10.204 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:35:10.209 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:35:10.212 +02:00 [INF] Transaction persisted for UserId 3: TransactionRequest { UserId = 3, TransactionTypeId = 3, Amount = 3000.00, Fee = 0 }
2025-11-18 14:35:10.214 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:35:10.216 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 57.8429ms
2025-11-18 14:35:10.218 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:10.219 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 77.3148ms
2025-11-18 14:35:13.798 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:35:13.808 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:13.810 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:35:13.816 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionTypeId] = 3 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:35:13.821 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:35:13.824 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:35:13.829 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:35:13.835 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:35:13.838 +02:00 [INF] Final fee: 0, Discount: 0
2025-11-18 14:35:13.844 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:35:13.850 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:35:13.853 +02:00 [INF] Transaction persisted for UserId 3: TransactionRequest { UserId = 3, TransactionTypeId = 3, Amount = 3100.00, Fee = 0 }
2025-11-18 14:35:13.854 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:35:13.856 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 44.593ms
2025-11-18 14:35:13.858 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:13.859 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 61.1534ms
2025-11-18 14:35:16.789 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:35:16.796 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:16.800 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:35:16.804 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionTypeId] = 3 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:35:16.805 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:35:16.806 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:35:16.808 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:35:16.810 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:35:16.812 +02:00 [INF] Final fee: 0, Discount: 0
2025-11-18 14:35:16.819 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:35:16.821 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:35:16.824 +02:00 [INF] Transaction persisted for UserId 3: TransactionRequest { UserId = 3, TransactionTypeId = 3, Amount = 3200.00, Fee = 0 }
2025-11-18 14:35:16.825 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:35:16.827 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 25.1095ms
2025-11-18 14:35:16.829 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:16.830 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 42.949ms
2025-11-18 14:35:20.619 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:35:20.623 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:20.625 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:35:20.630 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionTypeId] = 3 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:35:20.634 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:35:20.639 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:35:20.642 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:35:20.647 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:35:20.649 +02:00 [INF] Final fee: 2.25, Discount: 0.2500
2025-11-18 14:35:20.658 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:35:20.663 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:35:20.666 +02:00 [INF] Transaction persisted for UserId 3: TransactionRequest { UserId = 3, TransactionTypeId = 3, Amount = 3300.00, Fee = 2.25 }
2025-11-18 14:35:20.668 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:35:20.669 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 41.2596ms
2025-11-18 14:35:20.671 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:20.673 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 54.3424ms
2025-11-18 14:35:23.842 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:35:23.857 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:23.858 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:35:23.863 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionTypeId] = 3 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:35:23.868 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:35:23.871 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:35:23.873 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:35:23.875 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:35:23.877 +02:00 [INF] Final fee: 2.12, Discount: 0.3750
2025-11-18 14:35:23.885 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:35:23.888 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:35:23.890 +02:00 [INF] Transaction persisted for UserId 3: TransactionRequest { UserId = 3, TransactionTypeId = 3, Amount = 3400.00, Fee = 2.12 }
2025-11-18 14:35:23.893 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:35:23.895 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 34.5259ms
2025-11-18 14:35:23.898 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:23.900 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 58.7876ms
2025-11-18 14:35:27.200 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:35:27.208 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:27.209 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:35:27.214 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionTypeId] = 3 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:35:27.221 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:35:27.225 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:35:27.229 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:35:27.234 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:35:27.236 +02:00 [INF] Final fee: 1.88, Discount: 0.6250
2025-11-18 14:35:27.243 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:35:27.247 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:35:27.250 +02:00 [INF] Transaction persisted for UserId 3: TransactionRequest { UserId = 3, TransactionTypeId = 3, Amount = 5000.00, Fee = 1.88 }
2025-11-18 14:35:27.252 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:35:27.254 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 42.3317ms
2025-11-18 14:35:27.255 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:27.256 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 57.0024ms
2025-11-18 14:35:30.353 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:35:30.360 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:30.361 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:35:30.367 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionTypeId] = 3 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:35:30.371 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:35:30.375 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:35:30.377 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:35:30.380 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:35:30.382 +02:00 [INF] Final fee: 3.60, Discount: 0.4000
2025-11-18 14:35:30.386 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:35:30.389 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:35:30.391 +02:00 [INF] Transaction persisted for UserId 3: TransactionRequest { UserId = 3, TransactionTypeId = 3, Amount = 6000.00, Fee = 3.60 }
2025-11-18 14:35:30.392 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:35:30.393 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 29.178ms
2025-11-18 14:35:30.394 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:30.396 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 43.5419ms
2025-11-18 14:35:33.752 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:35:33.758 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:33.760 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:35:33.765 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionTypeId] = 3 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:35:33.768 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:35:33.771 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:35:33.774 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:35:33.776 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:35:33.780 +02:00 [INF] Final fee: 3.40, Discount: 0.6000
2025-11-18 14:35:33.787 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:35:33.790 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:35:33.793 +02:00 [INF] Transaction persisted for UserId 3: TransactionRequest { UserId = 3, TransactionTypeId = 3, Amount = 7000.00, Fee = 3.40 }
2025-11-18 14:35:33.795 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:35:33.796 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 34.1505ms
2025-11-18 14:35:33.798 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:33.799 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 47.8819ms
2025-11-18 14:35:37.130 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:35:37.138 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:37.140 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:35:37.144 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionTypeId] = 3 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:35:37.150 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:35:37.153 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:35:37.156 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:35:37.159 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:35:37.162 +02:00 [INF] Final fee: 3.00, Discount: 1.0000
2025-11-18 14:35:37.171 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:35:37.175 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:35:37.178 +02:00 [INF] Transaction persisted for UserId 3: TransactionRequest { UserId = 3, TransactionTypeId = 3, Amount = 8000.00, Fee = 3.00 }
2025-11-18 14:35:37.181 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:35:37.182 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 40.0919ms
2025-11-18 14:35:37.184 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:37.185 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 56.1463ms
2025-11-18 14:35:40.550 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:35:40.559 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:40.562 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:35:40.567 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:35:40.571 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:35:40.574 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:35:40.577 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:35:40.582 +02:00 [INF] Final fee: 0, Discount: 0
2025-11-18 14:35:40.586 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:35:40.592 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:35:40.595 +02:00 [INF] Transaction persisted for UserId 4: TransactionRequest { UserId = 4, TransactionTypeId = 4, Amount = 4000.00, Fee = 0 }
2025-11-18 14:35:40.596 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:35:40.598 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 33.8617ms
2025-11-18 14:35:40.600 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:40.602 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 51.7637ms
2025-11-18 14:35:45.878 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:35:45.883 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:45.884 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:35:45.889 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:35:45.893 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:35:45.897 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:35:45.903 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:35:45.906 +02:00 [INF] Final fee: 0, Discount: 0
2025-11-18 14:35:45.914 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:35:45.918 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:35:45.921 +02:00 [INF] Transaction persisted for UserId 4: TransactionRequest { UserId = 4, TransactionTypeId = 4, Amount = 4100.00, Fee = 0 }
2025-11-18 14:35:45.922 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:35:45.924 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 37.2484ms
2025-11-18 14:35:45.926 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:45.928 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 49.5544ms
2025-11-18 14:35:49.543 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:35:49.549 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:49.551 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:35:49.555 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:35:49.559 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:35:49.563 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:35:49.567 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:35:49.570 +02:00 [INF] Final fee: 0, Discount: 0
2025-11-18 14:35:49.574 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:35:49.581 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:35:49.584 +02:00 [INF] Transaction persisted for UserId 4: TransactionRequest { UserId = 4, TransactionTypeId = 4, Amount = 4200.00, Fee = 0 }
2025-11-18 14:35:49.586 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:35:49.587 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 33.7761ms
2025-11-18 14:35:49.589 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:49.590 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 48.2222ms
2025-11-18 14:35:53.451 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:35:53.457 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:53.459 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:35:53.471 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:35:53.485 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:35:53.492 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:35:53.498 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:35:53.502 +02:00 [INF] Final fee: 16.88, Discount: 8.1250
2025-11-18 14:35:53.511 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:35:53.521 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:35:53.524 +02:00 [INF] Transaction persisted for UserId 4: TransactionRequest { UserId = 4, TransactionTypeId = 4, Amount = 4300.00, Fee = 16.88 }
2025-11-18 14:35:53.527 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:35:53.530 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 66.708ms
2025-11-18 14:35:53.532 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:53.534 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 83.5295ms
2025-11-18 14:35:57.388 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:35:57.392 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:57.394 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:35:57.400 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:35:57.412 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:35:57.418 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:35:57.423 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:35:57.425 +02:00 [INF] Final fee: 15.94, Discount: 9.0625
2025-11-18 14:35:57.433 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:35:57.439 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:35:57.442 +02:00 [INF] Transaction persisted for UserId 4: TransactionRequest { UserId = 4, TransactionTypeId = 4, Amount = 4400.00, Fee = 15.94 }
2025-11-18 14:35:57.444 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:35:57.446 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 49.2751ms
2025-11-18 14:35:57.447 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:35:57.449 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 60.7348ms
2025-11-18 14:36:00.323 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:36:00.330 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:36:00.332 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:36:00.343 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:36:00.356 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:36:00.363 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:36:00.368 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:36:00.371 +02:00 [INF] Final fee: 14.06, Discount: 10.9375
2025-11-18 14:36:00.377 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:36:00.385 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:36:00.388 +02:00 [INF] Transaction persisted for UserId 4: TransactionRequest { UserId = 4, TransactionTypeId = 4, Amount = 4500.00, Fee = 14.06 }
2025-11-18 14:36:00.389 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:36:00.391 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 56.041ms
2025-11-18 14:36:00.393 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:36:00.395 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 73.8856ms
2025-11-18 14:36:03.482 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:36:03.490 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:36:03.491 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:36:03.497 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:36:03.502 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:36:03.506 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:36:03.509 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:36:03.511 +02:00 [INF] Final fee: 0, Discount: 0
2025-11-18 14:36:03.519 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:36:03.523 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:36:03.527 +02:00 [INF] Transaction persisted for UserId 4: TransactionRequest { UserId = 4, TransactionTypeId = 4, Amount = 4600.00, Fee = 0 }
2025-11-18 14:36:03.529 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:36:03.531 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 35.9923ms
2025-11-18 14:36:03.532 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:36:03.533 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 51.8078ms
2025-11-18 14:36:07.490 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:36:07.498 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:36:07.500 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:36:07.506 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:36:07.509 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:36:07.513 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:36:07.516 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:36:07.518 +02:00 [INF] Final fee: 0, Discount: 0
2025-11-18 14:36:07.521 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:36:07.526 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:36:07.530 +02:00 [INF] Transaction persisted for UserId 4: TransactionRequest { UserId = 4, TransactionTypeId = 4, Amount = 4700.00, Fee = 0 }
2025-11-18 14:36:07.532 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:36:07.534 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 29.9632ms
2025-11-18 14:36:07.536 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:36:07.538 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 49.7745ms
2025-11-18 14:36:11.007 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 14:36:11.015 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:36:11.016 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:36:11.020 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:36:11.025 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 14:36:11.032 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 14:36:11.036 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 14:36:11.038 +02:00 [INF] Final fee: 0, Discount: 0
2025-11-18 14:36:11.043 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 14:36:11.049 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 14:36:11.051 +02:00 [INF] Transaction persisted for UserId 4: TransactionRequest { UserId = 4, TransactionTypeId = 4, Amount = 4800.00, Fee = 0 }
2025-11-18 14:36:11.052 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 14:36:11.053 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 35.9157ms
2025-11-18 14:36:11.055 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 14:36:11.056 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 49.6609ms
2025-11-18 14:44:28.579 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 14:44:28.632 +02:00 [WRN] No store type was specified for the decimal property 'BaseFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 14:44:28.634 +02:00 [WRN] No store type was specified for the decimal property 'FinalFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 14:44:28.635 +02:00 [WRN] No store type was specified for the decimal property 'TotalDiscount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 14:44:28.637 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'PromoCode'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 14:44:28.638 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'Tier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 14:44:28.639 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Transaction'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 14:44:28.640 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 14:44:28.641 +02:00 [WRN] No store type was specified for the decimal property 'FeeCharged' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 14:44:29.233 +02:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [BusinessHolidays] AS [b]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:44:29.267 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PaymentMethods] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:44:29.274 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PromoCodes] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:44:29.281 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Tiers] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:44:29.287 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [TransactionTypes] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:44:29.293 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:44:29.307 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Transactions] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:44:29.315 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [FeeModifiers] AS [f]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:44:29.559 +02:00 [INF] Now listening on: https://localhost:7261
2025-11-18 14:44:29.561 +02:00 [INF] Now listening on: http://localhost:5186
2025-11-18 14:44:29.668 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-18 14:44:29.669 +02:00 [INF] Hosting environment: Development
2025-11-18 14:44:29.670 +02:00 [INF] Content root path: C:\Users\User\source\repos\FeeCalculationEngine\FeeCalculationEngine.API
2025-11-18 14:44:30.468 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - null null
2025-11-18 14:44:30.740 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - 200 null text/html;charset=utf-8 289.249ms
2025-11-18 14:44:30.783 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - null null
2025-11-18 14:44:30.783 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - null null
2025-11-18 14:44:30.799 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - 200 16533 application/javascript; charset=utf-8 16.7682ms
2025-11-18 14:44:30.852 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - 200 null text/javascript; charset=UTF-8 70.1999ms
2025-11-18 14:44:30.882 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - null null
2025-11-18 14:44:30.902 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 20.412ms
2025-11-18 14:44:36.670 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Preview - application/json 99
2025-11-18 14:44:36.684 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Preview (FeeCalculationEngine.API)'
2025-11-18 14:44:36.712 +02:00 [INF] Route matched with {action = "Preview", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult] Preview(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 14:59:17.734 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 14:59:17.783 +02:00 [WRN] No store type was specified for the decimal property 'BaseFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 14:59:17.795 +02:00 [WRN] No store type was specified for the decimal property 'FinalFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 14:59:17.796 +02:00 [WRN] No store type was specified for the decimal property 'TotalDiscount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 14:59:17.798 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'PromoCode'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 14:59:17.802 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'Tier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 14:59:17.804 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Transaction'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 14:59:17.805 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 14:59:17.807 +02:00 [WRN] No store type was specified for the decimal property 'FeeCharged' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 14:59:18.396 +02:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [BusinessHolidays] AS [b]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:59:18.423 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PaymentMethods] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:59:18.431 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PromoCodes] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:59:18.440 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Tiers] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:59:18.450 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [TransactionTypes] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:59:18.461 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:59:18.478 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Transactions] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:59:18.488 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [FeeModifiers] AS [f]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 14:59:18.782 +02:00 [INF] Now listening on: https://localhost:7261
2025-11-18 14:59:18.784 +02:00 [INF] Now listening on: http://localhost:5186
2025-11-18 14:59:18.874 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-18 14:59:18.878 +02:00 [INF] Hosting environment: Development
2025-11-18 14:59:18.879 +02:00 [INF] Content root path: C:\Users\User\source\repos\FeeCalculationEngine\FeeCalculationEngine.API
2025-11-18 14:59:19.701 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - null null
2025-11-18 14:59:19.984 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - 200 null text/html;charset=utf-8 305.314ms
2025-11-18 14:59:20.034 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - null null
2025-11-18 14:59:20.034 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - null null
2025-11-18 14:59:20.047 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - 200 16533 application/javascript; charset=utf-8 13.6384ms
2025-11-18 14:59:20.095 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - 200 null text/javascript; charset=UTF-8 60.9414ms
2025-11-18 14:59:20.122 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - null null
2025-11-18 14:59:20.143 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 21.8055ms
2025-11-18 15:29:32.201 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 15:29:32.329 +02:00 [WRN] No store type was specified for the decimal property 'BaseFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 15:29:32.337 +02:00 [WRN] No store type was specified for the decimal property 'FinalFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 15:29:32.340 +02:00 [WRN] No store type was specified for the decimal property 'TotalDiscount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 15:29:32.344 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'PromoCode'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 15:29:32.347 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'Tier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 15:29:32.354 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Transaction'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 15:29:32.357 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 15:29:32.360 +02:00 [WRN] No store type was specified for the decimal property 'FeeCharged' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 15:29:33.858 +02:00 [INF] Executed DbCommand (38ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [BusinessHolidays] AS [b]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 15:29:33.938 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PaymentMethods] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 15:29:33.962 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PromoCodes] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 15:29:33.980 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Tiers] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 15:29:33.997 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [TransactionTypes] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 15:29:34.015 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 15:29:34.051 +02:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Transactions] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 15:29:34.079 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [FeeModifiers] AS [f]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 15:29:34.868 +02:00 [INF] Now listening on: https://localhost:7261
2025-11-18 15:29:34.871 +02:00 [INF] Now listening on: http://localhost:5186
2025-11-18 15:29:35.143 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-18 15:29:35.145 +02:00 [INF] Hosting environment: Development
2025-11-18 15:29:35.152 +02:00 [INF] Content root path: C:\Users\User\source\repos\FeeCalculationEngine\FeeCalculationEngine.API
2025-11-18 15:29:36.413 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - null null
2025-11-18 15:29:36.920 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - 200 null text/html;charset=utf-8 535.0081ms
2025-11-18 15:29:36.973 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - null null
2025-11-18 15:29:36.973 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - null null
2025-11-18 15:29:36.999 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - 200 16533 application/javascript; charset=utf-8 27.7866ms
2025-11-18 15:29:37.079 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - 200 null text/javascript; charset=UTF-8 107.8538ms
2025-11-18 15:29:37.121 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - null null
2025-11-18 15:29:37.158 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 38.0308ms
2025-11-18 15:31:52.851 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 15:31:52.939 +02:00 [WRN] No store type was specified for the decimal property 'BaseFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 15:31:52.945 +02:00 [WRN] No store type was specified for the decimal property 'FinalFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 15:31:52.950 +02:00 [WRN] No store type was specified for the decimal property 'TotalDiscount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 15:31:52.954 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'PromoCode'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 15:31:52.960 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'Tier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 15:31:52.965 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Transaction'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 15:31:52.970 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 15:31:52.974 +02:00 [WRN] No store type was specified for the decimal property 'FeeCharged' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 15:31:54.256 +02:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [BusinessHolidays] AS [b]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 15:31:54.326 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PaymentMethods] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 15:31:54.346 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PromoCodes] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 15:31:54.367 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Tiers] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 15:31:54.390 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [TransactionTypes] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 15:31:54.418 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 15:31:54.466 +02:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Transactions] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 15:31:54.491 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [FeeModifiers] AS [f]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 15:31:55.084 +02:00 [INF] Now listening on: https://localhost:7261
2025-11-18 15:31:55.089 +02:00 [INF] Now listening on: http://localhost:5186
2025-11-18 15:31:55.316 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-18 15:31:55.320 +02:00 [INF] Hosting environment: Development
2025-11-18 15:31:55.322 +02:00 [INF] Content root path: C:\Users\User\source\repos\FeeCalculationEngine\FeeCalculationEngine.API
2025-11-18 15:31:56.415 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - null null
2025-11-18 15:31:56.939 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - 200 null text/html;charset=utf-8 550.9266ms
2025-11-18 15:31:56.985 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - null null
2025-11-18 15:31:56.985 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - null null
2025-11-18 15:31:57.036 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - 200 16533 application/javascript; charset=utf-8 53.1614ms
2025-11-18 15:31:57.096 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - 200 null text/javascript; charset=UTF-8 112.6452ms
2025-11-18 15:31:57.142 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - null null
2025-11-18 15:31:57.169 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 26.678ms
2025-11-18 15:32:01.624 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Preview - application/json 99
2025-11-18 15:32:01.653 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Preview (FeeCalculationEngine.API)'
2025-11-18 15:32:01.716 +02:00 [INF] Route matched with {action = "Preview", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult] Preview(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 15:32:02.109 +02:00 [INF] Executed DbCommand (63ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 15:32:19.261 +02:00 [INF] Executed DbCommand (14ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 15:32:22.784 +02:00 [INF] Executed DbCommand (45ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 15:32:23.026 +02:00 [INF] Executed DbCommand (59ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 15:32:23.188 +02:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CONVERT(date, [b].[HolidaysDate])
FROM [BusinessHolidays] AS [b]
2025-11-18 15:32:23.257 +02:00 [INF] Final fee: 10.12, Discount: 4.875000000
2025-11-18 15:32:23.861 +02:00 [INF] Executed DbCommand (52ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 15:32:23.950 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 15:32:23.978 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Preview (FeeCalculationEngine.API) in 22250.2895ms
2025-11-18 15:32:23.983 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Preview (FeeCalculationEngine.API)'
2025-11-18 15:32:23.994 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Preview - 200 null application/json; charset=utf-8 22370.1923ms
2025-11-18 15:51:12.887 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 15:51:12.945 +02:00 [WRN] No store type was specified for the decimal property 'BaseFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 15:51:12.951 +02:00 [WRN] No store type was specified for the decimal property 'FinalFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 15:51:12.953 +02:00 [WRN] No store type was specified for the decimal property 'TotalDiscount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 15:51:12.965 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'PromoCode'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 15:51:12.967 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'Tier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 15:51:12.971 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Transaction'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 15:51:12.973 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 15:51:12.974 +02:00 [WRN] No store type was specified for the decimal property 'FeeCharged' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 15:51:13.617 +02:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [BusinessHolidays] AS [b]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 15:51:13.652 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PaymentMethods] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 15:51:13.662 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PromoCodes] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 15:51:13.670 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Tiers] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 15:51:13.679 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [TransactionTypes] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 15:51:13.700 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 15:51:13.718 +02:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Transactions] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 15:51:13.743 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [FeeModifiers] AS [f]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 15:51:14.147 +02:00 [INF] Now listening on: https://localhost:7261
2025-11-18 15:51:14.154 +02:00 [INF] Now listening on: http://localhost:5186
2025-11-18 15:51:14.268 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-18 15:51:14.270 +02:00 [INF] Hosting environment: Development
2025-11-18 15:51:14.289 +02:00 [INF] Content root path: C:\Users\User\source\repos\FeeCalculationEngine\FeeCalculationEngine.API
2025-11-18 15:51:15.294 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - null null
2025-11-18 15:51:15.581 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - 200 null text/html;charset=utf-8 308.1194ms
2025-11-18 15:51:15.640 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - null null
2025-11-18 15:51:15.640 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - null null
2025-11-18 15:51:15.686 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - 200 16533 application/javascript; charset=utf-8 47.0024ms
2025-11-18 15:51:15.721 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - 200 null text/javascript; charset=UTF-8 82.0625ms
2025-11-18 15:51:15.760 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - null null
2025-11-18 15:51:15.783 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 24.0201ms
2025-11-18 15:51:45.836 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/v1/Fees/Preview?UserId=1&TransactionTypeId=1&Amount=1000&PaymentMethodId=1&PromoCodeId=1 - null null
2025-11-18 15:51:45.869 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Preview (FeeCalculationEngine.API)'
2025-11-18 15:51:45.967 +02:00 [INF] Route matched with {action = "Preview", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult] Preview(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 15:51:46.330 +02:00 [INF] Executed DbCommand (94ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 15:51:46.635 +02:00 [INF] Executed DbCommand (47ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 15:51:46.887 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 15:51:46.950 +02:00 [INF] Executed DbCommand (37ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 15:51:47.034 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CONVERT(date, [b].[HolidaysDate])
FROM [BusinessHolidays] AS [b]
2025-11-18 15:51:47.069 +02:00 [INF] Final fee: 10.12, Discount: 4.8750000
2025-11-18 15:51:47.480 +02:00 [INF] Executed DbCommand (57ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 15:51:47.580 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 15:51:47.628 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Preview (FeeCalculationEngine.API) in 1644.0693ms
2025-11-18 15:51:47.637 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Preview (FeeCalculationEngine.API)'
2025-11-18 15:51:47.649 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/v1/Fees/Preview?UserId=1&TransactionTypeId=1&Amount=1000&PaymentMethodId=1&PromoCodeId=1 - 200 null application/json; charset=utf-8 1813.4882ms
2025-11-18 16:35:37.914 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 16:35:38.001 +02:00 [WRN] No store type was specified for the decimal property 'BaseFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 16:35:38.006 +02:00 [WRN] No store type was specified for the decimal property 'FinalFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 16:35:38.012 +02:00 [WRN] No store type was specified for the decimal property 'TotalDiscount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 16:35:38.017 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'PromoCode'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 16:35:38.021 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'Tier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 16:35:38.025 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Transaction'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 16:35:38.031 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 16:35:38.036 +02:00 [WRN] No store type was specified for the decimal property 'FeeCharged' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 16:35:39.240 +02:00 [INF] Executed DbCommand (52ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [BusinessHolidays] AS [b]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 16:35:39.303 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PaymentMethods] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 16:35:39.324 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PromoCodes] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 16:35:39.343 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Tiers] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 16:35:39.360 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [TransactionTypes] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 16:35:39.379 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 16:35:39.414 +02:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Transactions] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 16:35:39.439 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [FeeModifiers] AS [f]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 16:35:40.083 +02:00 [INF] Now listening on: https://localhost:7261
2025-11-18 16:35:40.091 +02:00 [INF] Now listening on: http://localhost:5186
2025-11-18 16:35:40.287 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-18 16:35:40.292 +02:00 [INF] Hosting environment: Development
2025-11-18 16:35:40.294 +02:00 [INF] Content root path: C:\Users\User\source\repos\FeeCalculationEngine\FeeCalculationEngine.API
2025-11-18 16:35:41.251 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - null null
2025-11-18 16:35:41.721 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - 200 null text/html;charset=utf-8 498.2798ms
2025-11-18 16:35:41.784 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - null null
2025-11-18 16:35:41.784 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - null null
2025-11-18 16:35:41.803 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - 200 16533 application/javascript; charset=utf-8 18.5392ms
2025-11-18 16:35:41.879 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - 200 null text/javascript; charset=UTF-8 95.553ms
2025-11-18 16:35:41.924 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - null null
2025-11-18 16:35:41.955 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 32.0264ms
2025-11-18 16:35:48.393 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 16:35:48.435 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 16:35:48.522 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 16:49:12.357 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 16:49:12.456 +02:00 [WRN] No store type was specified for the decimal property 'BaseFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 16:49:12.459 +02:00 [WRN] No store type was specified for the decimal property 'FinalFee' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 16:49:12.461 +02:00 [WRN] No store type was specified for the decimal property 'TotalDiscount' on entity type 'FeeAuditLog'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 16:49:12.464 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'PromoCode'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 16:49:12.466 +02:00 [WRN] No store type was specified for the decimal property 'DiscountPercentage' on entity type 'Tier'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 16:49:12.472 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Transaction'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 16:49:12.475 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 16:49:12.480 +02:00 [WRN] No store type was specified for the decimal property 'FeeCharged' on entity type 'UserTransactionHistory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-11-18 16:49:14.000 +02:00 [INF] Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [BusinessHolidays] AS [b]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 16:49:14.084 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PaymentMethods] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 16:49:14.106 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [PromoCodes] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 16:49:14.126 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Tiers] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 16:49:14.142 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [TransactionTypes] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 16:49:14.162 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 16:49:14.229 +02:00 [INF] Executed DbCommand (51ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Transactions] AS [t]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 16:49:14.255 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [FeeModifiers] AS [f]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 16:49:14.838 +02:00 [INF] Now listening on: https://localhost:7261
2025-11-18 16:49:14.843 +02:00 [INF] Now listening on: http://localhost:5186
2025-11-18 16:49:15.043 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-18 16:49:15.046 +02:00 [INF] Hosting environment: Development
2025-11-18 16:49:15.048 +02:00 [INF] Content root path: C:\Users\User\source\repos\FeeCalculationEngine\FeeCalculationEngine.API
2025-11-18 16:49:16.011 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - null null
2025-11-18 16:49:16.523 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - 200 null text/html;charset=utf-8 560.4586ms
2025-11-18 16:49:16.595 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - null null
2025-11-18 16:49:16.595 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - null null
2025-11-18 16:49:16.614 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - 200 16533 application/javascript; charset=utf-8 20.3381ms
2025-11-18 16:49:16.773 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - 200 null text/javascript; charset=UTF-8 179.2886ms
2025-11-18 16:49:16.824 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - null null
2025-11-18 16:49:16.853 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 29.4071ms
2025-11-18 16:49:26.316 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - application/json 99
2025-11-18 16:49:26.355 +02:00 [INF] Executing endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 16:49:26.419 +02:00 [INF] Route matched with {action = "Calculate", controller = "Fees"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult]] Calculate(FeeCalculationEngine.Application.Dtos.Requests.FeeCalculationRequest) on controller FeeCalculationEngine.API.Controllers.FeesController (FeeCalculationEngine.API).
2025-11-18 16:49:27.005 +02:00 [INF] Executed DbCommand (84ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionTypeId] = 3 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 16:49:27.020 +02:00 [INF] Withdrawal count for UserId 3: 10
2025-11-18 16:49:27.028 +02:00 [INF] Base fee: 2.50
2025-11-18 16:49:27.051 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [UserTransactionHistories] AS [u]
        WHERE [u].[UserId] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-18 16:49:27.262 +02:00 [INF] Executed DbCommand (20ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsFirstTime], [u].[IsHighVolume], [u].[Name], [u].[TierId], [t].[Id], [t].[CreatedAt], [t].[DiscountPercentage], [t].[Name]
FROM [Users] AS [u]
INNER JOIN [Tiers] AS [t] ON [u].[TierId] = [t].[Id]
WHERE [u].[Id] = @__userId_0
2025-11-18 16:49:27.439 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[@__8__locals1_request_UserId_0='?' (DbType = Int32), @__monthStart_1='?' (DbType = DateTime2), @__monthEnd_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [UserTransactionHistories] AS [u]
WHERE [u].[UserId] = @__8__locals1_request_UserId_0 AND [u].[TransactionDate] >= @__monthStart_1 AND [u].[TransactionDate] <= @__monthEnd_2
2025-11-18 16:49:27.501 +02:00 [INF] Executed DbCommand (38ms) [Parameters=[@__promoCodeId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Code], [p].[CreatedAt], [p].[DiscountPercentage], [p].[ExpiryDate], [p].[IsActive]
FROM [PromoCodes] AS [p]
WHERE [p].[Id] = @__promoCodeId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-11-18 16:49:27.544 +02:00 [INF] Modifier applied: PromoCodeDiscount, FeeDifference: 0.6250, NewFee: 1.8750
2025-11-18 16:49:27.594 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CONVERT(date, [b].[HolidaysDate])
FROM [BusinessHolidays] AS [b]
2025-11-18 16:49:27.636 +02:00 [INF] Final fee: 1.88, Discount: 0.6250
2025-11-18 16:49:28.102 +02:00 [INF] Executed DbCommand (75ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [FeeAuditLogs] ([Amount], [BaseFee], [Breakdown], [CreatedAt], [FinalFee], [StackingStrategy], [TotalDiscount], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-18 16:49:28.248 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserTransactionHistories] ([Amount], [CreatedAt], [FeeCharged], [TransactionDate], [TransactionTypeId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-18 16:49:28.265 +02:00 [INF] Transaction persisted for UserId 3: TransactionRequest { UserId = 3, TransactionTypeId = 3, Amount = 5000.00, Fee = 1.88 }
2025-11-18 16:49:28.290 +02:00 [INF] Executing ObjectResult, writing value of type 'FeeCalculationEngine.Application.Dtos.Responses.FeeCalculationResult'.
2025-11-18 16:49:28.329 +02:00 [INF] Executed action FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API) in 1888.745ms
2025-11-18 16:49:28.340 +02:00 [INF] Executed endpoint 'FeeCalculationEngine.API.Controllers.FeesController.Calculate (FeeCalculationEngine.API)'
2025-11-18 16:49:28.351 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/v1/Fees/Calculate - 200 null application/json; charset=utf-8 2035.1797ms
